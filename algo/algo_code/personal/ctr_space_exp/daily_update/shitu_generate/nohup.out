+ bash -x run_shitu.sh 20191028
+ bash /home/ling.fang/kinit.sh
+ USER_NAME=ad_user
+ HADOOP_HOME=/usr/local/hadoop-2.6.3
+ common_file=/home/ling.fang/script/tools/common.sh
+ source /home/ling.fang/script/tools/common.sh
++ bash /home/ling.fang/kinit_ad_user.sh
++ HADOOP_BIN=/usr/local/hadoop-2.6.3/bin/hadoop
+++ pwd
++ ROOT_DIR=/home/ad_user/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ '[' 1 -ge 1 ']'
+ DATE=20191028
+ '[' 1 -eq 2 ']'
+ JOB_TAG=_exp
++ pwd
+ ROOT_DIR=/home/ad_user/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ INPUTDIR='-input "/user/ad_user/ctr_space/ed_join_click/join/20191028/" '
+ echo -input '"/user/ad_user/ctr_space/ed_join_click/join/20191028/"'
-input "/user/ad_user/ctr_space/ed_join_click/join/20191028/"
+ OUTPUTDIR=/user/ad_user/ctr_space/model_train_exp/shitu/20191028/
+ PLID_EDCLKDIR=/user/ad_user/ctr_space/plid_stat_info/json
+ done_file=/user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS
+ loop_check /user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS 140 1
+ file=/user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS
+ ready=0
+ check_time=140
+ mode=1
+ echo 'input params:/user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS 140 1'
input params:/user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS 140 1
+ '[' 3 -ne 3 ']'
+ '[' 140 -gt 0 ']'
+ '[' 1 -eq 1 ']'
+ hadoop_check_ready
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS
+ ready=1
+ '[' 1 -eq 1 ']'
+ mylog '/user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS is ready!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191104-22:09:08
+ echo '[20191104-22:09:08] /user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS' is 'ready!'
[20191104-22:09:08] /user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS is ready!
+ return 0
+ python script/get_creative_info.py
+ OWNER_INFO=ad_user@cootek.cn
+ TASK_NAME=naga_ctr_generate_shitu_log
+ hadoop_run
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191028/
rm: `/user/ad_user/ctr_space/model_train_exp/shitu/20191028/': No such file or directory
+ /usr/local/hadoop-2.6.3/bin/hadoop jar /usr/local/hadoop-2.6.3/share/hadoop/tools/lib/hadoop-streaming-2.6.3.jar -libjars /home/ling.fang/script/tools/mr_plugins-1.0.jar -files script -D map.output.key.field.separator=# -D num.key.fields.for.partition=1 -D mapreduce.map.memory.mb=4096 -D mapreduce.map.java.opts=-Xmx3276m -Dmapred.map.tasks.speculative.execution=false -Dmapred.reduce.tasks.speculative.execution=false -Dstream.non.zero.exit.is.failure=false -Dmapred.job.priority=HIGH -Dmapreduce.job.queuename=root.ad-root.etl.dailyetl.high -Dmapred.map.tasks=1000 -Dmapred.reduce.tasks=200 -Dmapred.job.map.capacity=1000 -Dmapred.job.reduce.capacity=200 -Dmapred.job.name=naga_ctr_generate_shitu_log_20191028 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -outputformat org.apache.hadoop.mapred.lib.SuffixMultipleTextOutputFormat -mapper 'python script/mapper.py' -reducer 'python script/reducer.py' -input '"/user/ad_user/ctr_space/ed_join_click/join/20191028/"' -output /user/ad_user/ctr_space/model_train_exp/shitu/20191028/
19/11/04 22:09:12 INFO Configuration.deprecation: map.output.key.field.separator is deprecated. Instead, use mapreduce.map.output.key.field.separator
19/11/04 22:09:12 INFO Configuration.deprecation: mapred.map.tasks.speculative.execution is deprecated. Instead, use mapreduce.map.speculative
19/11/04 22:09:12 INFO Configuration.deprecation: mapred.reduce.tasks.speculative.execution is deprecated. Instead, use mapreduce.reduce.speculative
19/11/04 22:09:12 INFO Configuration.deprecation: mapred.job.priority is deprecated. Instead, use mapreduce.job.priority
19/11/04 22:09:12 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
19/11/04 22:09:12 INFO Configuration.deprecation: mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces
19/11/04 22:09:12 INFO Configuration.deprecation: mapred.job.name is deprecated. Instead, use mapreduce.job.name
packageJobJar: [/tmp/hadoop-unjar2161942349225350669/] [] /tmp/streamjob1592852378261647163.jar tmpDir=null
19/11/04 22:09:13 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/04 22:09:13 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/04 22:09:14 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 4011856 for ad_user on ha-hdfs:cootek
19/11/04 22:09:14 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4011856 for ad_user)
19/11/04 22:09:14 WARN token.Token: Cannot find class for token kind kms-dt
19/11/04 22:09:14 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 36 bf 90 8a 8a 01 6e 5a cc 14 8a 8d 30 9f 20 8e 02 7e
19/11/04 22:09:40 INFO lzo.GPLNativeCodeLoader: Loaded native gpl library from the embedded binaries
19/11/04 22:09:40 INFO lzo.LzoCodec: Successfully loaded & initialized native-lzo library [hadoop-lzo rev 52decc77982b58949890770d22720a91adce0c3f]
19/11/04 22:09:41 INFO mapred.FileInputFormat: Total input paths to process : 1000
19/11/04 22:09:45 INFO mapreduce.JobSubmitter: number of splits:1000
19/11/04 22:09:47 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1567079137842_597836
19/11/04 22:09:47 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4011856 for ad_user)
19/11/04 22:09:47 WARN token.Token: Cannot find class for token kind kms-dt
19/11/04 22:09:47 WARN token.Token: Cannot find class for token kind kms-dt
Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 36 bf 90 8a 8a 01 6e 5a cc 14 8a 8d 30 9f 20 8e 02 7e
19/11/04 22:09:47 INFO impl.YarnClientImpl: Submitted application application_1567079137842_597836
19/11/04 22:09:47 INFO mapreduce.Job: The url to track the job: http://hadoop2-namenode.corp.cootek.com:8088/proxy/application_1567079137842_597836/
19/11/04 22:09:47 INFO mapreduce.Job: Running job: job_1567079137842_597836
19/11/04 22:10:04 INFO mapreduce.Job: Job job_1567079137842_597836 running in uber mode : false
19/11/04 22:10:04 INFO mapreduce.Job:  map 0% reduce 0%
19/11/04 22:10:23 INFO mapreduce.Job:  map 1% reduce 0%
19/11/04 22:10:27 INFO mapreduce.Job:  map 2% reduce 0%
19/11/04 22:10:29 INFO mapreduce.Job:  map 3% reduce 0%
19/11/04 22:10:30 INFO mapreduce.Job:  map 4% reduce 0%
19/11/04 22:10:32 INFO mapreduce.Job:  map 5% reduce 0%
19/11/04 22:10:33 INFO mapreduce.Job:  map 6% reduce 0%
19/11/04 22:10:34 INFO mapreduce.Job:  map 7% reduce 0%
19/11/04 22:10:36 INFO mapreduce.Job:  map 8% reduce 0%
19/11/04 22:10:37 INFO mapreduce.Job:  map 9% reduce 0%
19/11/04 22:10:38 INFO mapreduce.Job:  map 10% reduce 0%
19/11/04 22:10:39 INFO mapreduce.Job:  map 11% reduce 0%
19/11/04 22:10:40 INFO mapreduce.Job:  map 12% reduce 0%
19/11/04 22:10:41 INFO mapreduce.Job:  map 13% reduce 0%
19/11/04 22:10:42 INFO mapreduce.Job:  map 14% reduce 0%
19/11/04 22:10:43 INFO mapreduce.Job:  map 15% reduce 0%
19/11/04 22:10:44 INFO mapreduce.Job:  map 16% reduce 0%
19/11/04 22:10:45 INFO mapreduce.Job:  map 17% reduce 0%
19/11/04 22:10:46 INFO mapreduce.Job:  map 18% reduce 0%
19/11/04 22:10:47 INFO mapreduce.Job:  map 20% reduce 0%
19/11/04 22:10:48 INFO mapreduce.Job:  map 21% reduce 0%
19/11/04 22:10:49 INFO mapreduce.Job:  map 23% reduce 0%
19/11/04 22:10:50 INFO mapreduce.Job:  map 24% reduce 0%
19/11/04 22:10:51 INFO mapreduce.Job:  map 25% reduce 0%
19/11/04 22:10:52 INFO mapreduce.Job:  map 27% reduce 0%
19/11/04 22:10:53 INFO mapreduce.Job:  map 28% reduce 0%
19/11/04 22:10:54 INFO mapreduce.Job:  map 29% reduce 0%
19/11/04 22:10:55 INFO mapreduce.Job:  map 30% reduce 0%
19/11/04 22:10:56 INFO mapreduce.Job:  map 32% reduce 0%
19/11/04 22:10:57 INFO mapreduce.Job:  map 33% reduce 0%
19/11/04 22:10:58 INFO mapreduce.Job:  map 34% reduce 0%
19/11/04 22:11:00 INFO mapreduce.Job:  map 35% reduce 0%
19/11/04 22:11:01 INFO mapreduce.Job:  map 36% reduce 0%
19/11/04 22:11:02 INFO mapreduce.Job:  map 37% reduce 0%
19/11/04 22:11:04 INFO mapreduce.Job:  map 38% reduce 0%
19/11/04 22:11:09 INFO mapreduce.Job:  map 39% reduce 0%
19/11/04 22:11:16 INFO mapreduce.Job:  map 40% reduce 0%
19/11/04 22:11:25 INFO mapreduce.Job:  map 41% reduce 0%
+ bash -x run_shitu.sh 20191028
+ bash /home/ling.fang/kinit_ad_user.sh
+ USER_NAME=ad_user
+ HADOOP_HOME=/usr/local/hadoop-2.6.3
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ common_file=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+ source /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
++ bash /home/ling.fang/kinit_ad_user.sh
++ HADOOP_BIN=/usr/local/hadoop-2.6.3/bin/hadoop
++++ dirname /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+++ cd /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools
+++ pwd
++ ROOT_PATH=/home/work/ling.fang/personal/ling.fang/script/tools
+ '[' 1 -ge 1 ']'
+ DATE=20191028
+ '[' 1 -eq 2 ']'
+ JOB_TAG=_exp
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ INPUTDIR='-input "/user/ad_user/ctr_space/ed_join_click/join/20191028/" '
+ echo -input '"/user/ad_user/ctr_space/ed_join_click/join/20191028/"'
-input "/user/ad_user/ctr_space/ed_join_click/join/20191028/"
+ OUTPUTDIR=/user/ad_user/ctr_space/model_train_exp/shitu/20191028/
+ PLID_EDCLKDIR=/user/ad_user/ctr_space/plid_stat_info/json
+ done_file=/user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS
+ loop_check /user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS 140 1
+ file=/user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS
+ ready=0
+ check_time=140
+ mode=1
+ echo 'input params:/user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS 140 1'
input params:/user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS 140 1
+ '[' 3 -ne 3 ']'
+ '[' 140 -gt 0 ']'
+ '[' 1 -eq 1 ']'
+ hadoop_check_ready
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS
+ ready=1
+ '[' 1 -eq 1 ']'
+ mylog '/user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS is ready!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-01:37:46
+ echo '[20191106-01:37:46] /user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS' is 'ready!'
[20191106-01:37:46] /user/ad_user/ctr_space/ed_join_click/join/20191028/_SUCCESS is ready!
+ return 0
+ python script/get_creative_info.py
+ OWNER_INFO=ad_user@cootek.cn
+ TASK_NAME=naga_ctr_generate_shitu_log
+ hadoop_run
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191028/
rm: `/user/ad_user/ctr_space/model_train_exp/shitu/20191028/': No such file or directory
+ /usr/local/hadoop-2.6.3/bin/hadoop jar /usr/local/hadoop-2.6.3/share/hadoop/tools/lib/hadoop-streaming-2.6.3.jar -libjars /home/ling.fang/script/tools/mr_plugins-1.0.jar -files script -D map.output.key.field.separator=# -D num.key.fields.for.partition=1 -D mapreduce.map.memory.mb=4096 -D mapreduce.map.java.opts=-Xmx3276m -Dmapred.map.tasks.speculative.execution=false -Dmapred.reduce.tasks.speculative.execution=false -Dstream.non.zero.exit.is.failure=false -Dmapred.job.priority=HIGH -Dmapreduce.job.queuename=root.ad-root.etl.dailyetl.high -Dmapred.map.tasks=1000 -Dmapred.reduce.tasks=200 -Dmapred.job.map.capacity=1000 -Dmapred.job.reduce.capacity=200 -Dmapred.job.name=naga_ctr_generate_shitu_log_20191028 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -outputformat org.apache.hadoop.mapred.lib.SuffixMultipleTextOutputFormat -mapper 'python script/mapper.py' -reducer 'python script/reducer.py' -input '"/user/ad_user/ctr_space/ed_join_click/join/20191028/"' -output /user/ad_user/ctr_space/model_train_exp/shitu/20191028/
19/11/06 01:37:51 INFO Configuration.deprecation: map.output.key.field.separator is deprecated. Instead, use mapreduce.map.output.key.field.separator
19/11/06 01:37:51 INFO Configuration.deprecation: mapred.map.tasks.speculative.execution is deprecated. Instead, use mapreduce.map.speculative
19/11/06 01:37:51 INFO Configuration.deprecation: mapred.reduce.tasks.speculative.execution is deprecated. Instead, use mapreduce.reduce.speculative
19/11/06 01:37:51 INFO Configuration.deprecation: mapred.job.priority is deprecated. Instead, use mapreduce.job.priority
19/11/06 01:37:51 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
19/11/06 01:37:51 INFO Configuration.deprecation: mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces
19/11/06 01:37:51 INFO Configuration.deprecation: mapred.job.name is deprecated. Instead, use mapreduce.job.name
packageJobJar: [/tmp/hadoop-unjar8643119710583698826/] [] /tmp/streamjob644505264167835937.jar tmpDir=null
19/11/06 01:37:52 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 01:37:52 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 01:37:53 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 4046346 for ad_user on ha-hdfs:cootek
19/11/06 01:37:53 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046346 for ad_user)
19/11/06 01:37:53 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 01:37:53 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c a4 f1 9e 8a 01 6e 60 b1 75 9e 8d 31 02 46 8e 02 7f
19/11/06 01:37:56 INFO lzo.GPLNativeCodeLoader: Loaded native gpl library from the embedded binaries
19/11/06 01:37:56 INFO lzo.LzoCodec: Successfully loaded & initialized native-lzo library [hadoop-lzo rev 52decc77982b58949890770d22720a91adce0c3f]
19/11/06 01:37:57 INFO mapred.FileInputFormat: Total input paths to process : 1000
19/11/06 01:37:57 INFO mapreduce.JobSubmitter: number of splits:1000
19/11/06 01:37:57 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1567079137842_610541
19/11/06 01:37:57 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046346 for ad_user)
19/11/06 01:37:57 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 01:37:57 WARN token.Token: Cannot find class for token kind kms-dt
Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c a4 f1 9e 8a 01 6e 60 b1 75 9e 8d 31 02 46 8e 02 7f
19/11/06 01:37:58 INFO impl.YarnClientImpl: Submitted application application_1567079137842_610541
19/11/06 01:37:58 INFO mapreduce.Job: The url to track the job: http://hadoop2-namenode.corp.cootek.com:8088/proxy/application_1567079137842_610541/
19/11/06 01:37:58 INFO mapreduce.Job: Running job: job_1567079137842_610541
19/11/06 01:39:43 INFO mapreduce.Job: Job job_1567079137842_610541 running in uber mode : false
19/11/06 01:39:43 INFO mapreduce.Job:  map 0% reduce 0%
19/11/06 01:40:04 INFO mapreduce.Job:  map 1% reduce 0%
19/11/06 01:40:09 INFO mapreduce.Job:  map 2% reduce 0%
19/11/06 01:40:12 INFO mapreduce.Job:  map 3% reduce 0%
19/11/06 01:40:15 INFO mapreduce.Job:  map 4% reduce 0%
19/11/06 01:40:17 INFO mapreduce.Job:  map 5% reduce 0%
19/11/06 01:40:20 INFO mapreduce.Job:  map 6% reduce 0%
19/11/06 01:40:22 INFO mapreduce.Job:  map 7% reduce 0%
19/11/06 01:40:23 INFO mapreduce.Job:  map 8% reduce 0%
19/11/06 01:40:25 INFO mapreduce.Job:  map 9% reduce 0%
19/11/06 01:40:27 INFO mapreduce.Job:  map 10% reduce 0%
19/11/06 01:40:28 INFO mapreduce.Job:  map 11% reduce 0%
19/11/06 01:40:29 INFO mapreduce.Job:  map 12% reduce 0%
19/11/06 01:40:30 INFO mapreduce.Job:  map 13% reduce 0%
19/11/06 01:40:32 INFO mapreduce.Job:  map 14% reduce 0%
19/11/06 01:40:33 INFO mapreduce.Job:  map 15% reduce 0%
19/11/06 01:40:35 INFO mapreduce.Job:  map 16% reduce 0%
19/11/06 01:40:37 INFO mapreduce.Job:  map 17% reduce 0%
19/11/06 01:40:38 INFO mapreduce.Job:  map 18% reduce 0%
19/11/06 01:40:39 INFO mapreduce.Job:  map 19% reduce 0%
19/11/06 01:40:41 INFO mapreduce.Job:  map 20% reduce 0%
19/11/06 01:40:43 INFO mapreduce.Job:  map 21% reduce 0%
19/11/06 01:40:44 INFO mapreduce.Job:  map 22% reduce 0%
19/11/06 01:40:47 INFO mapreduce.Job:  map 23% reduce 0%
19/11/06 01:40:48 INFO mapreduce.Job:  map 24% reduce 0%
19/11/06 01:40:50 INFO mapreduce.Job:  map 25% reduce 0%
19/11/06 01:40:53 INFO mapreduce.Job:  map 26% reduce 0%
19/11/06 01:40:54 INFO mapreduce.Job:  map 27% reduce 0%
19/11/06 01:40:57 INFO mapreduce.Job:  map 28% reduce 0%
19/11/06 01:40:59 INFO mapreduce.Job:  map 29% reduce 0%
19/11/06 01:41:00 INFO mapreduce.Job:  map 30% reduce 0%
19/11/06 01:41:02 INFO mapreduce.Job:  map 31% reduce 0%
19/11/06 01:41:03 INFO mapreduce.Job:  map 32% reduce 0%
19/11/06 01:41:06 INFO mapreduce.Job:  map 33% reduce 0%
19/11/06 01:41:08 INFO mapreduce.Job:  map 34% reduce 0%
19/11/06 01:41:09 INFO mapreduce.Job:  map 35% reduce 0%
19/11/06 01:41:11 INFO mapreduce.Job:  map 36% reduce 0%
19/11/06 01:41:13 INFO mapreduce.Job:  map 37% reduce 0%
19/11/06 01:41:14 INFO mapreduce.Job:  map 38% reduce 0%
19/11/06 01:41:16 INFO mapreduce.Job:  map 39% reduce 0%
19/11/06 01:41:18 INFO mapreduce.Job:  map 40% reduce 0%
19/11/06 01:41:20 INFO mapreduce.Job:  map 41% reduce 0%
19/11/06 01:41:22 INFO mapreduce.Job:  map 42% reduce 0%
19/11/06 01:41:24 INFO mapreduce.Job:  map 43% reduce 0%
19/11/06 01:41:25 INFO mapreduce.Job:  map 44% reduce 0%
19/11/06 01:41:27 INFO mapreduce.Job:  map 45% reduce 0%
19/11/06 01:41:28 INFO mapreduce.Job:  map 46% reduce 0%
19/11/06 01:41:30 INFO mapreduce.Job:  map 47% reduce 0%
19/11/06 01:41:32 INFO mapreduce.Job:  map 48% reduce 0%
19/11/06 01:41:33 INFO mapreduce.Job:  map 49% reduce 0%
19/11/06 01:41:35 INFO mapreduce.Job:  map 50% reduce 0%
19/11/06 01:41:36 INFO mapreduce.Job:  map 51% reduce 0%
19/11/06 01:41:38 INFO mapreduce.Job:  map 52% reduce 0%
19/11/06 01:41:39 INFO mapreduce.Job:  map 53% reduce 0%
19/11/06 01:41:41 INFO mapreduce.Job:  map 54% reduce 0%
19/11/06 01:41:42 INFO mapreduce.Job:  map 55% reduce 0%
19/11/06 01:41:43 INFO mapreduce.Job:  map 56% reduce 0%
19/11/06 01:41:45 INFO mapreduce.Job:  map 57% reduce 0%
19/11/06 01:41:46 INFO mapreduce.Job:  map 58% reduce 0%
19/11/06 01:41:47 INFO mapreduce.Job:  map 59% reduce 0%
19/11/06 01:41:49 INFO mapreduce.Job:  map 60% reduce 0%
19/11/06 01:41:50 INFO mapreduce.Job:  map 61% reduce 0%
19/11/06 01:41:51 INFO mapreduce.Job:  map 62% reduce 0%
19/11/06 01:41:52 INFO mapreduce.Job:  map 63% reduce 0%
19/11/06 01:41:54 INFO mapreduce.Job:  map 64% reduce 0%
19/11/06 01:41:56 INFO mapreduce.Job:  map 65% reduce 0%
19/11/06 01:41:58 INFO mapreduce.Job:  map 66% reduce 0%
19/11/06 01:41:59 INFO mapreduce.Job:  map 67% reduce 0%
19/11/06 01:42:01 INFO mapreduce.Job:  map 68% reduce 0%
19/11/06 01:42:02 INFO mapreduce.Job:  map 69% reduce 0%
19/11/06 01:42:03 INFO mapreduce.Job:  map 70% reduce 0%
19/11/06 01:42:05 INFO mapreduce.Job:  map 71% reduce 0%
19/11/06 01:42:07 INFO mapreduce.Job:  map 72% reduce 0%
19/11/06 01:42:08 INFO mapreduce.Job:  map 73% reduce 0%
19/11/06 01:42:10 INFO mapreduce.Job:  map 74% reduce 0%
19/11/06 01:42:11 INFO mapreduce.Job:  map 75% reduce 0%
19/11/06 01:42:13 INFO mapreduce.Job:  map 76% reduce 0%
19/11/06 01:42:14 INFO mapreduce.Job:  map 77% reduce 0%
19/11/06 01:42:16 INFO mapreduce.Job:  map 78% reduce 0%
19/11/06 01:42:17 INFO mapreduce.Job:  map 79% reduce 0%
19/11/06 01:42:18 INFO mapreduce.Job:  map 80% reduce 0%
19/11/06 01:42:20 INFO mapreduce.Job:  map 81% reduce 0%
19/11/06 01:42:21 INFO mapreduce.Job:  map 82% reduce 0%
19/11/06 01:42:22 INFO mapreduce.Job:  map 83% reduce 0%
19/11/06 01:42:24 INFO mapreduce.Job:  map 84% reduce 0%
19/11/06 01:42:25 INFO mapreduce.Job:  map 85% reduce 0%
19/11/06 01:42:26 INFO mapreduce.Job:  map 86% reduce 0%
19/11/06 01:42:29 INFO mapreduce.Job:  map 87% reduce 0%
19/11/06 01:42:31 INFO mapreduce.Job:  map 88% reduce 0%
19/11/06 01:42:33 INFO mapreduce.Job:  map 89% reduce 0%
19/11/06 01:42:36 INFO mapreduce.Job:  map 90% reduce 0%
19/11/06 01:42:37 INFO mapreduce.Job:  map 90% reduce 2%
19/11/06 01:42:38 INFO mapreduce.Job:  map 91% reduce 5%
19/11/06 01:42:39 INFO mapreduce.Job:  map 91% reduce 7%
19/11/06 01:42:40 INFO mapreduce.Job:  map 92% reduce 9%
19/11/06 01:42:42 INFO mapreduce.Job:  map 92% reduce 10%
19/11/06 01:42:43 INFO mapreduce.Job:  map 93% reduce 11%
19/11/06 01:42:44 INFO mapreduce.Job:  map 93% reduce 12%
19/11/06 01:42:47 INFO mapreduce.Job:  map 94% reduce 12%
19/11/06 01:42:54 INFO mapreduce.Job:  map 95% reduce 12%
19/11/06 01:43:00 INFO mapreduce.Job:  map 96% reduce 12%
19/11/06 01:43:02 INFO mapreduce.Job:  map 96% reduce 13%
19/11/06 01:43:29 INFO mapreduce.Job:  map 97% reduce 13%
19/11/06 01:44:00 INFO mapreduce.Job:  map 98% reduce 13%
19/11/06 01:44:09 INFO mapreduce.Job:  map 98% reduce 15%
19/11/06 01:44:11 INFO mapreduce.Job:  map 98% reduce 16%
19/11/06 01:44:12 INFO mapreduce.Job:  map 98% reduce 21%
19/11/06 01:44:13 INFO mapreduce.Job:  map 98% reduce 25%
19/11/06 01:44:14 INFO mapreduce.Job:  map 99% reduce 28%
19/11/06 01:44:15 INFO mapreduce.Job:  map 99% reduce 29%
19/11/06 01:44:16 INFO mapreduce.Job:  map 99% reduce 31%
19/11/06 01:44:17 INFO mapreduce.Job:  map 99% reduce 33%
19/11/06 01:44:27 INFO mapreduce.Job:  map 100% reduce 33%
19/11/06 01:44:58 INFO mapreduce.Job:  map 100% reduce 36%
19/11/06 01:44:59 INFO mapreduce.Job:  map 100% reduce 44%
19/11/06 01:45:00 INFO mapreduce.Job:  map 100% reduce 55%
19/11/06 01:45:01 INFO mapreduce.Job:  map 100% reduce 63%
19/11/06 01:45:02 INFO mapreduce.Job:  map 100% reduce 67%
19/11/06 01:45:04 INFO mapreduce.Job:  map 100% reduce 68%
19/11/06 01:45:06 INFO mapreduce.Job:  map 100% reduce 69%
19/11/06 01:45:08 INFO mapreduce.Job:  map 100% reduce 70%
19/11/06 01:45:10 INFO mapreduce.Job:  map 100% reduce 71%
19/11/06 01:45:12 INFO mapreduce.Job:  map 100% reduce 72%
19/11/06 01:45:14 INFO mapreduce.Job:  map 100% reduce 73%
19/11/06 01:45:17 INFO mapreduce.Job:  map 100% reduce 74%
19/11/06 01:45:20 INFO mapreduce.Job:  map 100% reduce 75%
19/11/06 01:45:22 INFO mapreduce.Job:  map 100% reduce 76%
19/11/06 01:45:25 INFO mapreduce.Job:  map 100% reduce 77%
19/11/06 01:45:27 INFO mapreduce.Job:  map 100% reduce 78%
19/11/06 01:45:30 INFO mapreduce.Job:  map 100% reduce 79%
19/11/06 01:45:34 INFO mapreduce.Job:  map 100% reduce 80%
19/11/06 01:45:36 INFO mapreduce.Job:  map 100% reduce 81%
19/11/06 01:45:39 INFO mapreduce.Job:  map 100% reduce 82%
19/11/06 01:45:42 INFO mapreduce.Job:  map 100% reduce 83%
19/11/06 01:45:43 INFO mapreduce.Job:  map 100% reduce 84%
19/11/06 01:45:46 INFO mapreduce.Job:  map 100% reduce 85%
19/11/06 01:45:48 INFO mapreduce.Job:  map 100% reduce 86%
19/11/06 01:45:51 INFO mapreduce.Job:  map 100% reduce 87%
19/11/06 01:45:54 INFO mapreduce.Job:  map 100% reduce 88%
19/11/06 01:45:55 INFO mapreduce.Job:  map 100% reduce 89%
19/11/06 01:45:57 INFO mapreduce.Job:  map 100% reduce 90%
19/11/06 01:46:00 INFO mapreduce.Job:  map 100% reduce 91%
19/11/06 01:46:01 INFO mapreduce.Job:  map 100% reduce 92%
19/11/06 01:46:04 INFO mapreduce.Job:  map 100% reduce 93%
19/11/06 01:46:07 INFO mapreduce.Job:  map 100% reduce 94%
19/11/06 01:46:10 INFO mapreduce.Job:  map 100% reduce 95%
19/11/06 01:46:12 INFO mapreduce.Job:  map 100% reduce 96%
19/11/06 01:46:15 INFO mapreduce.Job:  map 100% reduce 97%
19/11/06 01:46:21 INFO mapreduce.Job:  map 100% reduce 98%
19/11/06 01:46:32 INFO mapreduce.Job:  map 100% reduce 99%
19/11/06 01:47:10 INFO mapreduce.Job:  map 100% reduce 100%
19/11/06 01:47:44 INFO mapreduce.Job: Task Id : attempt_1567079137842_610541_r_000158_0, Status : FAILED
Error: java.lang.RuntimeException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException): No lease on /user/ad_user/ctr_space/model_train_exp/shitu/20191028/_temporary/1/_temporary/attempt_1567079137842_610541_r_000158_0/part-00158-A (inode 3234389037): File does not exist. Holder DFSClient_attempt_1567079137842_610541_r_000158_0_820581179_1 does not have any open files.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkLease(FSNamesystem.java:3603)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.analyzeFileState(FSNamesystem.java:3400)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:3256)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.addBlock(NameNodeRpcServer.java:670)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.addBlock(ClientNamenodeProtocolServerSideTranslatorPB.java:482)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:619)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:962)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2044)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2040)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1656)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2038)

	at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:336)
	at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:535)
	at org.apache.hadoop.streaming.PipeReducer.close(PipeReducer.java:134)
	at org.apache.hadoop.io.IOUtils.cleanup(IOUtils.java:237)
	at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:459)
	at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:392)
	at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:163)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1656)
	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)
Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException): No lease on /user/ad_user/ctr_space/model_train_exp/shitu/20191028/_temporary/1/_temporary/attempt_1567079137842_610541_r_000158_0/part-00158-A (inode 3234389037): File does not exist. Holder DFSClient_attempt_1567079137842_610541_r_000158_0_820581179_1 does not have any open files.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkLease(FSNamesystem.java:3603)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.analyzeFileState(FSNamesystem.java:3400)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:3256)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.addBlock(NameNodeRpcServer.java:670)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.addBlock(ClientNamenodeProtocolServerSideTranslatorPB.java:482)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:619)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:962)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2044)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2040)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1656)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2038)

	at org.apache.hadoop.ipc.Client.call(Client.java:1469)
	at org.apache.hadoop.ipc.Client.call(Client.java:1400)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:232)
	at com.sun.proxy.$Proxy13.addBlock(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.addBlock(ClientNamenodeProtocolTranslatorPB.java:399)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)
	at com.sun.proxy.$Proxy14.addBlock(Unknown Source)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.locateFollowingBlock(DFSOutputStream.java:1532)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.nextBlockOutputStream(DFSOutputStream.java:1349)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:588)

19/11/06 01:47:44 INFO mapreduce.Job: Task Id : attempt_1567079137842_610541_r_000026_0, Status : FAILED
Error: java.lang.RuntimeException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException): No lease on /user/ad_user/ctr_space/model_train_exp/shitu/20191028/_temporary/1/_temporary/attempt_1567079137842_610541_r_000026_0/part-00026-A (inode 3234389010): File does not exist. Holder DFSClient_attempt_1567079137842_610541_r_000026_0_-1365683935_1 does not have any open files.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkLease(FSNamesystem.java:3603)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.analyzeFileState(FSNamesystem.java:3400)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:3256)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.addBlock(NameNodeRpcServer.java:670)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.addBlock(ClientNamenodeProtocolServerSideTranslatorPB.java:482)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:619)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:962)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2044)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2040)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1656)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2038)

	at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:336)
	at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:535)
	at org.apache.hadoop.streaming.PipeReducer.close(PipeReducer.java:134)
	at org.apache.hadoop.io.IOUtils.cleanup(IOUtils.java:237)
	at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:459)
	at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:392)
	at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:163)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1656)
	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)
Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException): No lease on /user/ad_user/ctr_space/model_train_exp/shitu/20191028/_temporary/1/_temporary/attempt_1567079137842_610541_r_000026_0/part-00026-A (inode 3234389010): File does not exist. Holder DFSClient_attempt_1567079137842_610541_r_000026_0_-1365683935_1 does not have any open files.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkLease(FSNamesystem.java:3603)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.analyzeFileState(FSNamesystem.java:3400)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:3256)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.addBlock(NameNodeRpcServer.java:670)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.addBlock(ClientNamenodeProtocolServerSideTranslatorPB.java:482)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:619)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:962)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2044)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2040)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1656)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2038)

	at org.apache.hadoop.ipc.Client.call(Client.java:1469)
	at org.apache.hadoop.ipc.Client.call(Client.java:1400)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:232)
	at com.sun.proxy.$Proxy13.addBlock(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.addBlock(ClientNamenodeProtocolTranslatorPB.java:399)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)
	at com.sun.proxy.$Proxy14.addBlock(Unknown Source)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.locateFollowingBlock(DFSOutputStream.java:1532)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.nextBlockOutputStream(DFSOutputStream.java:1349)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:588)

19/11/06 01:47:45 INFO mapreduce.Job:  map 100% reduce 99%
19/11/06 01:47:45 INFO mapreduce.Job: Task Id : attempt_1567079137842_610541_r_000134_0, Status : FAILED
Error: java.lang.RuntimeException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException): No lease on /user/ad_user/ctr_space/model_train_exp/shitu/20191028/_temporary/1/_temporary/attempt_1567079137842_610541_r_000134_0/part-00134-A (inode 3234388837): File does not exist. Holder DFSClient_attempt_1567079137842_610541_r_000134_0_1832046548_1 does not have any open files.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkLease(FSNamesystem.java:3603)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.analyzeFileState(FSNamesystem.java:3400)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:3256)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.addBlock(NameNodeRpcServer.java:670)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.addBlock(ClientNamenodeProtocolServerSideTranslatorPB.java:482)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:619)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:962)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2044)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2040)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1656)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2038)

	at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:336)
	at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:535)
	at org.apache.hadoop.streaming.PipeReducer.close(PipeReducer.java:134)
	at org.apache.hadoop.io.IOUtils.cleanup(IOUtils.java:237)
	at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:459)
	at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:392)
	at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:163)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1656)
	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)
Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException): No lease on /user/ad_user/ctr_space/model_train_exp/shitu/20191028/_temporary/1/_temporary/attempt_1567079137842_610541_r_000134_0/part-00134-A (inode 3234388837): File does not exist. Holder DFSClient_attempt_1567079137842_610541_r_000134_0_1832046548_1 does not have any open files.
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkLease(FSNamesystem.java:3603)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.analyzeFileState(FSNamesystem.java:3400)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:3256)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.addBlock(NameNodeRpcServer.java:670)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.addBlock(ClientNamenodeProtocolServerSideTranslatorPB.java:482)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:619)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:962)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2044)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2040)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1656)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2038)

	at org.apache.hadoop.ipc.Client.call(Client.java:1469)
	at org.apache.hadoop.ipc.Client.call(Client.java:1400)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:232)
	at com.sun.proxy.$Proxy13.addBlock(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.addBlock(ClientNamenodeProtocolTranslatorPB.java:399)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)
	at com.sun.proxy.$Proxy14.addBlock(Unknown Source)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.locateFollowingBlock(DFSOutputStream.java:1532)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.nextBlockOutputStream(DFSOutputStream.java:1349)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:588)

19/11/06 01:48:06 INFO mapreduce.Job:  map 100% reduce 100%
19/11/06 01:48:52 INFO mapreduce.Job: Job job_1567079137842_610541 completed successfully
19/11/06 01:48:52 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=17773080354
		FILE: Number of bytes written=51132209196
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=151041268728
		HDFS: Number of bytes written=198310897423
		HDFS: Number of read operations=3600
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=800
	Job Counters 
		Failed reduce tasks=3
		Launched map tasks=1000
		Launched reduce tasks=203
		Data-local map tasks=946
		Rack-local map tasks=54
		Total time spent by all maps in occupied slots (ms)=285970632
		Total time spent by all reduces in occupied slots (ms)=208607658
		Total time spent by all map tasks (ms)=35746329
		Total time spent by all reduce tasks (ms)=34767943
		Total vcore-milliseconds taken by all map tasks=35746329
		Total vcore-milliseconds taken by all reduce tasks=34767943
		Total megabyte-milliseconds taken by all map tasks=146416963584
		Total megabyte-milliseconds taken by all reduce tasks=106807120896
	Map-Reduce Framework
		Map input records=71005974
		Map output records=229091407
		Map output bytes=146896480392
		Map output materialized bytes=33207013874
		Input split bytes=174000
		Combine input records=0
		Combine output records=0
		Reduce input groups=7815423
		Reduce shuffle bytes=33207013874
		Reduce input records=229091407
		Reduce output records=143415487
		Spilled Records=458182814
		Shuffled Maps =200000
		Failed Shuffles=0
		Merged Map outputs=200000
		GC time elapsed (ms)=257670
		CPU time spent (ms)=53594600
		Physical memory (bytes) snapshot=1634319253504
		Virtual memory (bytes) snapshot=6294796931072
		Total committed heap usage (bytes)=2247440203776
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=151041094728
	File Output Format Counters 
		Bytes Written=198310897423
19/11/06 01:48:52 INFO streaming.StreamJob: Output directory: /user/ad_user/ctr_space/model_train_exp/shitu/20191028/
+ judge_result hadoop_run
+ [[ 0 -ne 0 ]]
+ echo 'hadoop_run success.'
hadoop_run success.
+ ADFEA_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/adfea/
+ ADFEA_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191028/
+ INS_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/ins/
+ INS_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/ins//20191028/
+ STATINFO_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/
+ STATINFO_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191028/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191028/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191028/
19/11/06 01:48:58 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/adfea/20191028' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191028/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191028/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191028/
19/11/06 01:49:08 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/ins/20191028' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191028/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191028/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191028/
19/11/06 01:49:18 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/20191028' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191028/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191028//part-*-A' /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191028/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191028//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191028//part-*-B' /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191028/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191028//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191028//part-*-C' /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191028/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191028//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191028/
19/11/06 01:49:48 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191028' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ mylog 'task[20191028] success!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-01:49:49
+ echo '[20191106-01:49:49] task[20191028]' 'success!'
[20191106-01:49:49] task[20191028] success!
+ exit 0
+ bash -x run_shitu.sh 20191029
+ bash /home/ling.fang/kinit_ad_user.sh
+ USER_NAME=ad_user
+ HADOOP_HOME=/usr/local/hadoop-2.6.3
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ common_file=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+ source /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
++ bash /home/ling.fang/kinit_ad_user.sh
++ HADOOP_BIN=/usr/local/hadoop-2.6.3/bin/hadoop
++++ dirname /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+++ cd /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools
+++ pwd
++ ROOT_PATH=/home/work/ling.fang/personal/ling.fang/script/tools
+ '[' 1 -ge 1 ']'
+ DATE=20191029
+ '[' 1 -eq 2 ']'
+ JOB_TAG=_exp
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ INPUTDIR='-input "/user/ad_user/ctr_space/ed_join_click/join/20191029/" '
+ echo -input '"/user/ad_user/ctr_space/ed_join_click/join/20191029/"'
-input "/user/ad_user/ctr_space/ed_join_click/join/20191029/"
+ OUTPUTDIR=/user/ad_user/ctr_space/model_train_exp/shitu/20191029/
+ PLID_EDCLKDIR=/user/ad_user/ctr_space/plid_stat_info/json
+ done_file=/user/ad_user/ctr_space/ed_join_click/join/20191029/_SUCCESS
+ loop_check /user/ad_user/ctr_space/ed_join_click/join/20191029/_SUCCESS 140 1
+ file=/user/ad_user/ctr_space/ed_join_click/join/20191029/_SUCCESS
+ ready=0
+ check_time=140
+ mode=1
+ echo 'input params:/user/ad_user/ctr_space/ed_join_click/join/20191029/_SUCCESS 140 1'
input params:/user/ad_user/ctr_space/ed_join_click/join/20191029/_SUCCESS 140 1
+ '[' 3 -ne 3 ']'
+ '[' 140 -gt 0 ']'
+ '[' 1 -eq 1 ']'
+ hadoop_check_ready
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/ed_join_click/join/20191029/_SUCCESS
+ ready=1
+ '[' 1 -eq 1 ']'
+ mylog '/user/ad_user/ctr_space/ed_join_click/join/20191029/_SUCCESS is ready!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-01:49:52
+ echo '[20191106-01:49:52] /user/ad_user/ctr_space/ed_join_click/join/20191029/_SUCCESS' is 'ready!'
[20191106-01:49:52] /user/ad_user/ctr_space/ed_join_click/join/20191029/_SUCCESS is ready!
+ return 0
+ python script/get_creative_info.py
+ OWNER_INFO=ad_user@cootek.cn
+ TASK_NAME=naga_ctr_generate_shitu_log
+ hadoop_run
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191029/
19/11/06 01:49:55 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191029' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop jar /usr/local/hadoop-2.6.3/share/hadoop/tools/lib/hadoop-streaming-2.6.3.jar -libjars /home/ling.fang/script/tools/mr_plugins-1.0.jar -files script -D map.output.key.field.separator=# -D num.key.fields.for.partition=1 -D mapreduce.map.memory.mb=4096 -D mapreduce.map.java.opts=-Xmx3276m -Dmapred.map.tasks.speculative.execution=false -Dmapred.reduce.tasks.speculative.execution=false -Dstream.non.zero.exit.is.failure=false -Dmapred.job.priority=HIGH -Dmapreduce.job.queuename=root.ad-root.etl.dailyetl.high -Dmapred.map.tasks=1000 -Dmapred.reduce.tasks=200 -Dmapred.job.map.capacity=1000 -Dmapred.job.reduce.capacity=200 -Dmapred.job.name=naga_ctr_generate_shitu_log_20191029 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -outputformat org.apache.hadoop.mapred.lib.SuffixMultipleTextOutputFormat -mapper 'python script/mapper.py' -reducer 'python script/reducer.py' -input '"/user/ad_user/ctr_space/ed_join_click/join/20191029/"' -output /user/ad_user/ctr_space/model_train_exp/shitu/20191029/
19/11/06 01:49:57 INFO Configuration.deprecation: map.output.key.field.separator is deprecated. Instead, use mapreduce.map.output.key.field.separator
19/11/06 01:49:57 INFO Configuration.deprecation: mapred.map.tasks.speculative.execution is deprecated. Instead, use mapreduce.map.speculative
19/11/06 01:49:57 INFO Configuration.deprecation: mapred.reduce.tasks.speculative.execution is deprecated. Instead, use mapreduce.reduce.speculative
19/11/06 01:49:57 INFO Configuration.deprecation: mapred.job.priority is deprecated. Instead, use mapreduce.job.priority
19/11/06 01:49:57 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
19/11/06 01:49:57 INFO Configuration.deprecation: mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces
19/11/06 01:49:57 INFO Configuration.deprecation: mapred.job.name is deprecated. Instead, use mapreduce.job.name
packageJobJar: [/tmp/hadoop-unjar6058888134229638200/] [] /tmp/streamjob3856722309739526016.jar tmpDir=null
19/11/06 01:49:58 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 01:49:59 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 01:49:59 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 4046383 for ad_user on ha-hdfs:cootek
19/11/06 01:49:59 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046383 for ad_user)
19/11/06 01:49:59 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 01:49:59 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c b0 07 f1 8a 01 6e 60 bc 8b f1 8d 31 02 6b 8e 02 7f
19/11/06 01:50:05 INFO lzo.GPLNativeCodeLoader: Loaded native gpl library from the embedded binaries
19/11/06 01:50:05 INFO lzo.LzoCodec: Successfully loaded & initialized native-lzo library [hadoop-lzo rev 52decc77982b58949890770d22720a91adce0c3f]
19/11/06 01:50:05 INFO mapred.FileInputFormat: Total input paths to process : 1000
19/11/06 01:50:06 INFO mapreduce.JobSubmitter: number of splits:1000
19/11/06 01:50:07 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1567079137842_610576
19/11/06 01:50:07 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046383 for ad_user)
19/11/06 01:50:07 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 01:50:07 WARN token.Token: Cannot find class for token kind kms-dt
Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c b0 07 f1 8a 01 6e 60 bc 8b f1 8d 31 02 6b 8e 02 7f
19/11/06 01:50:07 INFO impl.YarnClientImpl: Submitted application application_1567079137842_610576
19/11/06 01:50:08 INFO mapreduce.Job: The url to track the job: http://hadoop2-namenode.corp.cootek.com:8088/proxy/application_1567079137842_610576/
19/11/06 01:50:08 INFO mapreduce.Job: Running job: job_1567079137842_610576
19/11/06 01:50:32 INFO mapreduce.Job: Job job_1567079137842_610576 running in uber mode : false
19/11/06 01:50:32 INFO mapreduce.Job:  map 0% reduce 0%
19/11/06 01:50:51 INFO mapreduce.Job:  map 1% reduce 0%
19/11/06 01:50:55 INFO mapreduce.Job:  map 2% reduce 0%
19/11/06 01:50:58 INFO mapreduce.Job:  map 3% reduce 0%
19/11/06 01:51:00 INFO mapreduce.Job:  map 4% reduce 0%
19/11/06 01:51:02 INFO mapreduce.Job:  map 5% reduce 0%
19/11/06 01:51:03 INFO mapreduce.Job:  map 6% reduce 0%
19/11/06 01:51:05 INFO mapreduce.Job:  map 7% reduce 0%
19/11/06 01:51:06 INFO mapreduce.Job:  map 8% reduce 0%
19/11/06 01:51:07 INFO mapreduce.Job:  map 9% reduce 0%
19/11/06 01:51:09 INFO mapreduce.Job:  map 10% reduce 0%
19/11/06 01:51:10 INFO mapreduce.Job:  map 11% reduce 0%
19/11/06 01:51:11 INFO mapreduce.Job:  map 12% reduce 0%
19/11/06 01:51:12 INFO mapreduce.Job:  map 13% reduce 0%
19/11/06 01:51:14 INFO mapreduce.Job:  map 14% reduce 0%
19/11/06 01:51:15 INFO mapreduce.Job:  map 16% reduce 0%
19/11/06 01:51:17 INFO mapreduce.Job:  map 17% reduce 0%
19/11/06 01:51:18 INFO mapreduce.Job:  map 19% reduce 0%
19/11/06 01:51:20 INFO mapreduce.Job:  map 21% reduce 0%
19/11/06 01:51:21 INFO mapreduce.Job:  map 22% reduce 0%
19/11/06 01:51:22 INFO mapreduce.Job:  map 23% reduce 0%
19/11/06 01:51:23 INFO mapreduce.Job:  map 24% reduce 0%
19/11/06 01:51:24 INFO mapreduce.Job:  map 25% reduce 0%
19/11/06 01:51:25 INFO mapreduce.Job:  map 26% reduce 0%
19/11/06 01:51:26 INFO mapreduce.Job:  map 27% reduce 0%
19/11/06 01:51:28 INFO mapreduce.Job:  map 28% reduce 0%
19/11/06 01:51:29 INFO mapreduce.Job:  map 29% reduce 0%
19/11/06 01:51:30 INFO mapreduce.Job:  map 30% reduce 0%
19/11/06 01:51:31 INFO mapreduce.Job:  map 32% reduce 0%
19/11/06 01:51:32 INFO mapreduce.Job:  map 33% reduce 0%
19/11/06 01:51:33 INFO mapreduce.Job:  map 34% reduce 0%
19/11/06 01:51:34 INFO mapreduce.Job:  map 35% reduce 0%
19/11/06 01:51:35 INFO mapreduce.Job:  map 36% reduce 0%
19/11/06 01:51:36 INFO mapreduce.Job:  map 37% reduce 0%
19/11/06 01:51:38 INFO mapreduce.Job:  map 38% reduce 0%
19/11/06 01:51:40 INFO mapreduce.Job:  map 39% reduce 0%
19/11/06 01:51:41 INFO mapreduce.Job:  map 40% reduce 0%
19/11/06 01:51:43 INFO mapreduce.Job:  map 41% reduce 0%
19/11/06 01:51:44 INFO mapreduce.Job:  map 42% reduce 0%
19/11/06 01:51:46 INFO mapreduce.Job:  map 43% reduce 0%
19/11/06 01:51:47 INFO mapreduce.Job:  map 44% reduce 0%
19/11/06 01:51:48 INFO mapreduce.Job:  map 45% reduce 0%
19/11/06 01:51:49 INFO mapreduce.Job:  map 46% reduce 0%
19/11/06 01:51:51 INFO mapreduce.Job:  map 47% reduce 0%
19/11/06 01:51:52 INFO mapreduce.Job:  map 48% reduce 0%
19/11/06 01:51:53 INFO mapreduce.Job:  map 49% reduce 0%
19/11/06 01:51:54 INFO mapreduce.Job:  map 50% reduce 0%
19/11/06 01:51:55 INFO mapreduce.Job:  map 51% reduce 0%
19/11/06 01:51:56 INFO mapreduce.Job:  map 52% reduce 0%
19/11/06 01:51:57 INFO mapreduce.Job:  map 53% reduce 0%
19/11/06 01:51:58 INFO mapreduce.Job:  map 54% reduce 0%
19/11/06 01:51:59 INFO mapreduce.Job:  map 55% reduce 0%
19/11/06 01:52:00 INFO mapreduce.Job:  map 56% reduce 0%
19/11/06 01:52:01 INFO mapreduce.Job:  map 57% reduce 0%
19/11/06 01:52:02 INFO mapreduce.Job:  map 58% reduce 0%
19/11/06 01:52:03 INFO mapreduce.Job:  map 59% reduce 0%
19/11/06 01:52:04 INFO mapreduce.Job:  map 60% reduce 0%
19/11/06 01:52:05 INFO mapreduce.Job:  map 61% reduce 0%
19/11/06 01:52:07 INFO mapreduce.Job:  map 62% reduce 0%
19/11/06 01:52:08 INFO mapreduce.Job:  map 63% reduce 0%
19/11/06 01:52:09 INFO mapreduce.Job:  map 64% reduce 0%
19/11/06 01:52:10 INFO mapreduce.Job:  map 65% reduce 0%
19/11/06 01:52:11 INFO mapreduce.Job:  map 66% reduce 0%
19/11/06 01:52:12 INFO mapreduce.Job:  map 67% reduce 0%
19/11/06 01:52:13 INFO mapreduce.Job:  map 68% reduce 0%
19/11/06 01:52:14 INFO mapreduce.Job:  map 69% reduce 0%
19/11/06 01:52:15 INFO mapreduce.Job:  map 70% reduce 0%
19/11/06 01:52:16 INFO mapreduce.Job:  map 71% reduce 0%
19/11/06 01:52:18 INFO mapreduce.Job:  map 72% reduce 0%
19/11/06 01:52:19 INFO mapreduce.Job:  map 73% reduce 0%
19/11/06 01:52:20 INFO mapreduce.Job:  map 74% reduce 0%
19/11/06 01:52:22 INFO mapreduce.Job:  map 75% reduce 0%
19/11/06 01:52:23 INFO mapreduce.Job:  map 76% reduce 0%
19/11/06 01:52:25 INFO mapreduce.Job:  map 77% reduce 0%
19/11/06 01:52:26 INFO mapreduce.Job:  map 78% reduce 0%
19/11/06 01:52:27 INFO mapreduce.Job:  map 79% reduce 0%
19/11/06 01:52:28 INFO mapreduce.Job:  map 80% reduce 0%
19/11/06 01:52:30 INFO mapreduce.Job:  map 81% reduce 0%
19/11/06 01:52:31 INFO mapreduce.Job:  map 82% reduce 0%
19/11/06 01:52:32 INFO mapreduce.Job:  map 83% reduce 0%
19/11/06 01:52:33 INFO mapreduce.Job:  map 84% reduce 0%
19/11/06 01:52:34 INFO mapreduce.Job:  map 85% reduce 0%
19/11/06 01:52:35 INFO mapreduce.Job:  map 86% reduce 0%
19/11/06 01:52:36 INFO mapreduce.Job:  map 87% reduce 0%
19/11/06 01:52:37 INFO mapreduce.Job:  map 88% reduce 0%
19/11/06 01:52:39 INFO mapreduce.Job:  map 89% reduce 0%
19/11/06 01:52:40 INFO mapreduce.Job:  map 90% reduce 0%
19/11/06 01:52:41 INFO mapreduce.Job:  map 91% reduce 0%
19/11/06 01:52:42 INFO mapreduce.Job:  map 92% reduce 0%
19/11/06 01:52:43 INFO mapreduce.Job:  map 93% reduce 0%
19/11/06 01:52:45 INFO mapreduce.Job:  map 94% reduce 0%
19/11/06 01:52:46 INFO mapreduce.Job:  map 95% reduce 0%
19/11/06 01:52:48 INFO mapreduce.Job:  map 96% reduce 0%
19/11/06 01:52:50 INFO mapreduce.Job:  map 97% reduce 1%
19/11/06 01:52:51 INFO mapreduce.Job:  map 97% reduce 4%
19/11/06 01:52:52 INFO mapreduce.Job:  map 98% reduce 7%
19/11/06 01:52:53 INFO mapreduce.Job:  map 98% reduce 10%
19/11/06 01:52:54 INFO mapreduce.Job:  map 98% reduce 13%
19/11/06 01:52:55 INFO mapreduce.Job:  map 98% reduce 15%
19/11/06 01:52:56 INFO mapreduce.Job:  map 98% reduce 18%
19/11/06 01:52:58 INFO mapreduce.Job:  map 98% reduce 19%
19/11/06 01:52:59 INFO mapreduce.Job:  map 98% reduce 22%
19/11/06 01:53:00 INFO mapreduce.Job:  map 98% reduce 25%
19/11/06 01:53:01 INFO mapreduce.Job:  map 98% reduce 27%
19/11/06 01:53:02 INFO mapreduce.Job:  map 98% reduce 29%
19/11/06 01:53:03 INFO mapreduce.Job:  map 99% reduce 30%
19/11/06 01:53:04 INFO mapreduce.Job:  map 99% reduce 31%
19/11/06 01:53:06 INFO mapreduce.Job:  map 99% reduce 32%
19/11/06 01:53:08 INFO mapreduce.Job:  map 99% reduce 33%
19/11/06 01:53:25 INFO mapreduce.Job:  map 100% reduce 33%
19/11/06 01:53:31 INFO mapreduce.Job:  map 100% reduce 34%
19/11/06 01:53:32 INFO mapreduce.Job:  map 100% reduce 39%
19/11/06 01:53:33 INFO mapreduce.Job:  map 100% reduce 50%
19/11/06 01:53:34 INFO mapreduce.Job:  map 100% reduce 61%
19/11/06 01:53:35 INFO mapreduce.Job:  map 100% reduce 66%
19/11/06 01:53:36 INFO mapreduce.Job:  map 100% reduce 67%
19/11/06 01:53:37 INFO mapreduce.Job:  map 100% reduce 68%
19/11/06 01:53:39 INFO mapreduce.Job:  map 100% reduce 69%
19/11/06 01:53:41 INFO mapreduce.Job:  map 100% reduce 70%
19/11/06 01:53:43 INFO mapreduce.Job:  map 100% reduce 71%
19/11/06 01:53:44 INFO mapreduce.Job:  map 100% reduce 72%
19/11/06 01:53:46 INFO mapreduce.Job:  map 100% reduce 73%
19/11/06 01:53:48 INFO mapreduce.Job:  map 100% reduce 74%
19/11/06 01:53:50 INFO mapreduce.Job:  map 100% reduce 75%
19/11/06 01:53:52 INFO mapreduce.Job:  map 100% reduce 76%
19/11/06 01:53:54 INFO mapreduce.Job:  map 100% reduce 77%
19/11/06 01:53:56 INFO mapreduce.Job:  map 100% reduce 78%
19/11/06 01:53:58 INFO mapreduce.Job:  map 100% reduce 79%
19/11/06 01:54:00 INFO mapreduce.Job:  map 100% reduce 80%
19/11/06 01:54:02 INFO mapreduce.Job:  map 100% reduce 81%
19/11/06 01:54:04 INFO mapreduce.Job:  map 100% reduce 82%
19/11/06 01:54:06 INFO mapreduce.Job:  map 100% reduce 83%
19/11/06 01:54:08 INFO mapreduce.Job:  map 100% reduce 84%
19/11/06 01:54:10 INFO mapreduce.Job:  map 100% reduce 85%
19/11/06 01:54:13 INFO mapreduce.Job:  map 100% reduce 86%
19/11/06 01:54:15 INFO mapreduce.Job:  map 100% reduce 87%
19/11/06 01:54:17 INFO mapreduce.Job:  map 100% reduce 88%
19/11/06 01:54:19 INFO mapreduce.Job:  map 100% reduce 89%
19/11/06 01:54:21 INFO mapreduce.Job:  map 100% reduce 90%
19/11/06 01:54:23 INFO mapreduce.Job:  map 100% reduce 91%
19/11/06 01:54:25 INFO mapreduce.Job:  map 100% reduce 92%
19/11/06 01:54:27 INFO mapreduce.Job:  map 100% reduce 93%
19/11/06 01:54:30 INFO mapreduce.Job:  map 100% reduce 94%
19/11/06 01:54:33 INFO mapreduce.Job:  map 100% reduce 95%
19/11/06 01:54:37 INFO mapreduce.Job:  map 100% reduce 96%
19/11/06 01:54:42 INFO mapreduce.Job:  map 100% reduce 97%
19/11/06 01:54:55 INFO mapreduce.Job:  map 100% reduce 98%
19/11/06 01:55:13 INFO mapreduce.Job:  map 100% reduce 99%
19/11/06 01:55:48 INFO mapreduce.Job:  map 100% reduce 100%
19/11/06 01:56:41 INFO mapreduce.Job: Job job_1567079137842_610576 completed successfully
19/11/06 01:56:41 INFO mapreduce.Job: Counters: 50
	File System Counters
		FILE: Number of bytes read=18891409468
		FILE: Number of bytes written=54289315432
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=160213910078
		HDFS: Number of bytes written=208972303420
		HDFS: Number of read operations=3600
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=800
	Job Counters 
		Launched map tasks=1000
		Launched reduce tasks=200
		Data-local map tasks=953
		Rack-local map tasks=47
		Total time spent by all maps in occupied slots (ms)=330607768
		Total time spent by all reduces in occupied slots (ms)=138470100
		Total time spent by all map tasks (ms)=41325971
		Total time spent by all reduce tasks (ms)=23078350
		Total vcore-milliseconds taken by all map tasks=41325971
		Total vcore-milliseconds taken by all reduce tasks=23078350
		Total megabyte-milliseconds taken by all map tasks=169271177216
		Total megabyte-milliseconds taken by all reduce tasks=70896691200
	Map-Reduce Framework
		Map input records=74799857
		Map output records=241910602
		Map output bytes=154851652056
		Map output materialized bytes=35245792544
		Input split bytes=174000
		Combine input records=0
		Combine output records=0
		Reduce input groups=8173025
		Reduce shuffle bytes=35245792544
		Reduce input records=241910602
		Reduce output records=151068523
		Spilled Records=483821204
		Shuffled Maps =200000
		Failed Shuffles=0
		Merged Map outputs=200000
		GC time elapsed (ms)=275545
		CPU time spent (ms)=55958170
		Physical memory (bytes) snapshot=1629480828928
		Virtual memory (bytes) snapshot=6290002247680
		Total committed heap usage (bytes)=2228582088704
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=160213736078
	File Output Format Counters 
		Bytes Written=208972303420
19/11/06 01:56:41 INFO streaming.StreamJob: Output directory: /user/ad_user/ctr_space/model_train_exp/shitu/20191029/
+ judge_result hadoop_run
+ [[ 0 -ne 0 ]]
+ echo 'hadoop_run success.'
hadoop_run success.
+ ADFEA_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/adfea/
+ ADFEA_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191029/
+ INS_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/ins/
+ INS_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/ins//20191029/
+ STATINFO_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/
+ STATINFO_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191029/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191029/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191029/
19/11/06 01:56:47 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/adfea/20191029' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191029/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191029/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191029/
19/11/06 01:56:56 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/ins/20191029' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191029/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191029/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191029/
19/11/06 01:57:06 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/20191029' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191029/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191029//part-*-A' /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191029/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191029//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191029//part-*-B' /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191029/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191029//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191029//part-*-C' /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191029/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191029//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191029/
19/11/06 01:57:38 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191029' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ mylog 'task[20191029] success!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-01:57:38
+ echo '[20191106-01:57:38] task[20191029]' 'success!'
[20191106-01:57:38] task[20191029] success!
+ exit 0
+ bash -x run_shitu.sh 20191030
+ bash /home/ling.fang/kinit_ad_user.sh
+ USER_NAME=ad_user
+ HADOOP_HOME=/usr/local/hadoop-2.6.3
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ common_file=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+ source /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
++ bash /home/ling.fang/kinit_ad_user.sh
++ HADOOP_BIN=/usr/local/hadoop-2.6.3/bin/hadoop
++++ dirname /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+++ cd /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools
+++ pwd
++ ROOT_PATH=/home/work/ling.fang/personal/ling.fang/script/tools
+ '[' 1 -ge 1 ']'
+ DATE=20191030
+ '[' 1 -eq 2 ']'
+ JOB_TAG=_exp
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ INPUTDIR='-input "/user/ad_user/ctr_space/ed_join_click/join/20191030/" '
+ echo -input '"/user/ad_user/ctr_space/ed_join_click/join/20191030/"'
-input "/user/ad_user/ctr_space/ed_join_click/join/20191030/"
+ OUTPUTDIR=/user/ad_user/ctr_space/model_train_exp/shitu/20191030/
+ PLID_EDCLKDIR=/user/ad_user/ctr_space/plid_stat_info/json
+ done_file=/user/ad_user/ctr_space/ed_join_click/join/20191030/_SUCCESS
+ loop_check /user/ad_user/ctr_space/ed_join_click/join/20191030/_SUCCESS 140 1
+ file=/user/ad_user/ctr_space/ed_join_click/join/20191030/_SUCCESS
+ ready=0
+ check_time=140
+ mode=1
+ echo 'input params:/user/ad_user/ctr_space/ed_join_click/join/20191030/_SUCCESS 140 1'
input params:/user/ad_user/ctr_space/ed_join_click/join/20191030/_SUCCESS 140 1
+ '[' 3 -ne 3 ']'
+ '[' 140 -gt 0 ']'
+ '[' 1 -eq 1 ']'
+ hadoop_check_ready
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/ed_join_click/join/20191030/_SUCCESS
+ ready=1
+ '[' 1 -eq 1 ']'
+ mylog '/user/ad_user/ctr_space/ed_join_click/join/20191030/_SUCCESS is ready!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-01:57:41
+ echo '[20191106-01:57:41] /user/ad_user/ctr_space/ed_join_click/join/20191030/_SUCCESS' is 'ready!'
[20191106-01:57:41] /user/ad_user/ctr_space/ed_join_click/join/20191030/_SUCCESS is ready!
+ return 0
+ python script/get_creative_info.py
+ OWNER_INFO=ad_user@cootek.cn
+ TASK_NAME=naga_ctr_generate_shitu_log
+ hadoop_run
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191030/
19/11/06 01:57:44 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191030' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop jar /usr/local/hadoop-2.6.3/share/hadoop/tools/lib/hadoop-streaming-2.6.3.jar -libjars /home/ling.fang/script/tools/mr_plugins-1.0.jar -files script -D map.output.key.field.separator=# -D num.key.fields.for.partition=1 -D mapreduce.map.memory.mb=4096 -D mapreduce.map.java.opts=-Xmx3276m -Dmapred.map.tasks.speculative.execution=false -Dmapred.reduce.tasks.speculative.execution=false -Dstream.non.zero.exit.is.failure=false -Dmapred.job.priority=HIGH -Dmapreduce.job.queuename=root.ad-root.etl.dailyetl.high -Dmapred.map.tasks=1000 -Dmapred.reduce.tasks=200 -Dmapred.job.map.capacity=1000 -Dmapred.job.reduce.capacity=200 -Dmapred.job.name=naga_ctr_generate_shitu_log_20191030 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -outputformat org.apache.hadoop.mapred.lib.SuffixMultipleTextOutputFormat -mapper 'python script/mapper.py' -reducer 'python script/reducer.py' -input '"/user/ad_user/ctr_space/ed_join_click/join/20191030/"' -output /user/ad_user/ctr_space/model_train_exp/shitu/20191030/
19/11/06 01:57:47 INFO Configuration.deprecation: map.output.key.field.separator is deprecated. Instead, use mapreduce.map.output.key.field.separator
19/11/06 01:57:47 INFO Configuration.deprecation: mapred.map.tasks.speculative.execution is deprecated. Instead, use mapreduce.map.speculative
19/11/06 01:57:47 INFO Configuration.deprecation: mapred.reduce.tasks.speculative.execution is deprecated. Instead, use mapreduce.reduce.speculative
19/11/06 01:57:47 INFO Configuration.deprecation: mapred.job.priority is deprecated. Instead, use mapreduce.job.priority
19/11/06 01:57:47 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
19/11/06 01:57:47 INFO Configuration.deprecation: mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces
19/11/06 01:57:47 INFO Configuration.deprecation: mapred.job.name is deprecated. Instead, use mapreduce.job.name
packageJobJar: [/tmp/hadoop-unjar309884811293063909/] [] /tmp/streamjob1428516824785772388.jar tmpDir=null
19/11/06 01:57:47 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 01:57:48 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 01:57:48 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 4046417 for ad_user on ha-hdfs:cootek
19/11/06 01:57:48 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046417 for ad_user)
19/11/06 01:57:48 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 01:57:48 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c b7 2f a2 8a 01 6e 60 c3 b3 a2 8d 31 02 8d 8e 02 7f
19/11/06 01:57:48 ERROR streaming.StreamJob: Error Launching job : Output directory hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191030 already exists
Streaming Command Failed!
+ judge_result hadoop_run
+ [[ 5 -ne 0 ]]
+ echo 'hadoop_run failed.'
hadoop_run failed.
+ exit -1
+ bash -x run_shitu.sh 20191031
+ bash /home/ling.fang/kinit_ad_user.sh
+ USER_NAME=ad_user
+ HADOOP_HOME=/usr/local/hadoop-2.6.3
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ common_file=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+ source /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
++ bash /home/ling.fang/kinit_ad_user.sh
++ HADOOP_BIN=/usr/local/hadoop-2.6.3/bin/hadoop
++++ dirname /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+++ cd /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools
+++ pwd
++ ROOT_PATH=/home/work/ling.fang/personal/ling.fang/script/tools
+ '[' 1 -ge 1 ']'
+ DATE=20191031
+ '[' 1 -eq 2 ']'
+ JOB_TAG=_exp
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ INPUTDIR='-input "/user/ad_user/ctr_space/ed_join_click/join/20191031/" '
+ echo -input '"/user/ad_user/ctr_space/ed_join_click/join/20191031/"'
-input "/user/ad_user/ctr_space/ed_join_click/join/20191031/"
+ OUTPUTDIR=/user/ad_user/ctr_space/model_train_exp/shitu/20191031/
+ PLID_EDCLKDIR=/user/ad_user/ctr_space/plid_stat_info/json
+ done_file=/user/ad_user/ctr_space/ed_join_click/join/20191031/_SUCCESS
+ loop_check /user/ad_user/ctr_space/ed_join_click/join/20191031/_SUCCESS 140 1
+ file=/user/ad_user/ctr_space/ed_join_click/join/20191031/_SUCCESS
+ ready=0
+ check_time=140
+ mode=1
+ echo 'input params:/user/ad_user/ctr_space/ed_join_click/join/20191031/_SUCCESS 140 1'
input params:/user/ad_user/ctr_space/ed_join_click/join/20191031/_SUCCESS 140 1
+ '[' 3 -ne 3 ']'
+ '[' 140 -gt 0 ']'
+ '[' 1 -eq 1 ']'
+ hadoop_check_ready
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/ed_join_click/join/20191031/_SUCCESS
+ ready=1
+ '[' 1 -eq 1 ']'
+ mylog '/user/ad_user/ctr_space/ed_join_click/join/20191031/_SUCCESS is ready!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-01:57:52
+ echo '[20191106-01:57:52] /user/ad_user/ctr_space/ed_join_click/join/20191031/_SUCCESS' is 'ready!'
[20191106-01:57:52] /user/ad_user/ctr_space/ed_join_click/join/20191031/_SUCCESS is ready!
+ return 0
+ python script/get_creative_info.py
+ OWNER_INFO=ad_user@cootek.cn
+ TASK_NAME=naga_ctr_generate_shitu_log
+ hadoop_run
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191031/
rm: `/user/ad_user/ctr_space/model_train_exp/shitu/20191031/': No such file or directory
+ /usr/local/hadoop-2.6.3/bin/hadoop jar /usr/local/hadoop-2.6.3/share/hadoop/tools/lib/hadoop-streaming-2.6.3.jar -libjars /home/ling.fang/script/tools/mr_plugins-1.0.jar -files script -D map.output.key.field.separator=# -D num.key.fields.for.partition=1 -D mapreduce.map.memory.mb=4096 -D mapreduce.map.java.opts=-Xmx3276m -Dmapred.map.tasks.speculative.execution=false -Dmapred.reduce.tasks.speculative.execution=false -Dstream.non.zero.exit.is.failure=false -Dmapred.job.priority=HIGH -Dmapreduce.job.queuename=root.ad-root.etl.dailyetl.high -Dmapred.map.tasks=1000 -Dmapred.reduce.tasks=200 -Dmapred.job.map.capacity=1000 -Dmapred.job.reduce.capacity=200 -Dmapred.job.name=naga_ctr_generate_shitu_log_20191031 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -outputformat org.apache.hadoop.mapred.lib.SuffixMultipleTextOutputFormat -mapper 'python script/mapper.py' -reducer 'python script/reducer.py' -input '"/user/ad_user/ctr_space/ed_join_click/join/20191031/"' -output /user/ad_user/ctr_space/model_train_exp/shitu/20191031/
19/11/06 01:57:57 INFO Configuration.deprecation: map.output.key.field.separator is deprecated. Instead, use mapreduce.map.output.key.field.separator
19/11/06 01:57:57 INFO Configuration.deprecation: mapred.map.tasks.speculative.execution is deprecated. Instead, use mapreduce.map.speculative
19/11/06 01:57:57 INFO Configuration.deprecation: mapred.reduce.tasks.speculative.execution is deprecated. Instead, use mapreduce.reduce.speculative
19/11/06 01:57:57 INFO Configuration.deprecation: mapred.job.priority is deprecated. Instead, use mapreduce.job.priority
19/11/06 01:57:57 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
19/11/06 01:57:57 INFO Configuration.deprecation: mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces
19/11/06 01:57:57 INFO Configuration.deprecation: mapred.job.name is deprecated. Instead, use mapreduce.job.name
packageJobJar: [/tmp/hadoop-unjar5435168299516130540/] [] /tmp/streamjob8219322254781094883.jar tmpDir=null
19/11/06 01:57:58 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 01:57:58 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 01:57:58 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 4046418 for ad_user on ha-hdfs:cootek
19/11/06 01:57:59 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046418 for ad_user)
19/11/06 01:57:59 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 01:57:59 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c b7 58 0e 8a 01 6e 60 c3 dc 0e 8d 31 02 8e 8e 02 7f
19/11/06 01:58:06 INFO lzo.GPLNativeCodeLoader: Loaded native gpl library from the embedded binaries
19/11/06 01:58:06 INFO lzo.LzoCodec: Successfully loaded & initialized native-lzo library [hadoop-lzo rev 52decc77982b58949890770d22720a91adce0c3f]
19/11/06 01:58:06 INFO mapred.FileInputFormat: Total input paths to process : 1000
19/11/06 01:58:06 INFO mapreduce.JobSubmitter: number of splits:1000
19/11/06 01:58:06 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1567079137842_610606
19/11/06 01:58:06 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046418 for ad_user)
19/11/06 01:58:06 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 01:58:06 WARN token.Token: Cannot find class for token kind kms-dt
Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c b7 58 0e 8a 01 6e 60 c3 dc 0e 8d 31 02 8e 8e 02 7f
19/11/06 01:58:07 INFO impl.YarnClientImpl: Submitted application application_1567079137842_610606
19/11/06 01:58:07 INFO mapreduce.Job: The url to track the job: http://hadoop2-namenode.corp.cootek.com:8088/proxy/application_1567079137842_610606/
19/11/06 01:58:07 INFO mapreduce.Job: Running job: job_1567079137842_610606
19/11/06 01:58:16 INFO mapreduce.Job: Job job_1567079137842_610606 running in uber mode : false
19/11/06 01:58:16 INFO mapreduce.Job:  map 0% reduce 0%
19/11/06 01:58:33 INFO mapreduce.Job:  map 1% reduce 0%
19/11/06 01:58:36 INFO mapreduce.Job:  map 2% reduce 0%
19/11/06 01:58:39 INFO mapreduce.Job:  map 3% reduce 0%
19/11/06 01:58:41 INFO mapreduce.Job:  map 4% reduce 0%
19/11/06 01:58:43 INFO mapreduce.Job:  map 5% reduce 0%
19/11/06 01:58:44 INFO mapreduce.Job:  map 6% reduce 0%
19/11/06 01:58:45 INFO mapreduce.Job:  map 7% reduce 0%
19/11/06 01:58:47 INFO mapreduce.Job:  map 8% reduce 0%
19/11/06 01:58:48 INFO mapreduce.Job:  map 9% reduce 0%
19/11/06 01:58:49 INFO mapreduce.Job:  map 10% reduce 0%
19/11/06 01:58:50 INFO mapreduce.Job:  map 11% reduce 0%
19/11/06 01:58:51 INFO mapreduce.Job:  map 12% reduce 0%
19/11/06 01:58:53 INFO mapreduce.Job:  map 13% reduce 0%
19/11/06 01:58:54 INFO mapreduce.Job:  map 14% reduce 0%
19/11/06 01:58:55 INFO mapreduce.Job:  map 15% reduce 0%
19/11/06 01:58:56 INFO mapreduce.Job:  map 17% reduce 0%
19/11/06 01:58:57 INFO mapreduce.Job:  map 18% reduce 0%
19/11/06 01:58:58 INFO mapreduce.Job:  map 19% reduce 0%
19/11/06 01:58:59 INFO mapreduce.Job:  map 21% reduce 0%
19/11/06 01:59:00 INFO mapreduce.Job:  map 22% reduce 0%
19/11/06 01:59:01 INFO mapreduce.Job:  map 23% reduce 0%
19/11/06 01:59:02 INFO mapreduce.Job:  map 24% reduce 0%
19/11/06 01:59:03 INFO mapreduce.Job:  map 25% reduce 0%
19/11/06 01:59:04 INFO mapreduce.Job:  map 27% reduce 0%
19/11/06 01:59:05 INFO mapreduce.Job:  map 28% reduce 0%
19/11/06 01:59:07 INFO mapreduce.Job:  map 30% reduce 0%
19/11/06 01:59:08 INFO mapreduce.Job:  map 31% reduce 0%
19/11/06 01:59:09 INFO mapreduce.Job:  map 32% reduce 0%
19/11/06 01:59:10 INFO mapreduce.Job:  map 33% reduce 0%
19/11/06 01:59:11 INFO mapreduce.Job:  map 34% reduce 0%
19/11/06 01:59:12 INFO mapreduce.Job:  map 35% reduce 0%
19/11/06 01:59:13 INFO mapreduce.Job:  map 36% reduce 0%
19/11/06 01:59:15 INFO mapreduce.Job:  map 37% reduce 0%
19/11/06 01:59:16 INFO mapreduce.Job:  map 38% reduce 0%
19/11/06 01:59:18 INFO mapreduce.Job:  map 39% reduce 0%
19/11/06 01:59:19 INFO mapreduce.Job:  map 40% reduce 0%
19/11/06 01:59:20 INFO mapreduce.Job:  map 41% reduce 0%
19/11/06 01:59:21 INFO mapreduce.Job:  map 42% reduce 0%
19/11/06 01:59:22 INFO mapreduce.Job:  map 43% reduce 0%
19/11/06 01:59:23 INFO mapreduce.Job:  map 44% reduce 0%
19/11/06 01:59:25 INFO mapreduce.Job:  map 45% reduce 0%
19/11/06 01:59:26 INFO mapreduce.Job:  map 46% reduce 0%
19/11/06 01:59:27 INFO mapreduce.Job:  map 47% reduce 0%
19/11/06 01:59:28 INFO mapreduce.Job:  map 48% reduce 0%
19/11/06 01:59:29 INFO mapreduce.Job:  map 50% reduce 0%
19/11/06 01:59:30 INFO mapreduce.Job:  map 51% reduce 0%
19/11/06 01:59:31 INFO mapreduce.Job:  map 52% reduce 0%
19/11/06 01:59:32 INFO mapreduce.Job:  map 53% reduce 0%
19/11/06 01:59:33 INFO mapreduce.Job:  map 54% reduce 0%
19/11/06 01:59:34 INFO mapreduce.Job:  map 55% reduce 0%
19/11/06 01:59:35 INFO mapreduce.Job:  map 56% reduce 0%
19/11/06 01:59:36 INFO mapreduce.Job:  map 58% reduce 0%
19/11/06 01:59:37 INFO mapreduce.Job:  map 59% reduce 0%
19/11/06 01:59:38 INFO mapreduce.Job:  map 60% reduce 0%
19/11/06 01:59:39 INFO mapreduce.Job:  map 61% reduce 0%
19/11/06 01:59:40 INFO mapreduce.Job:  map 62% reduce 0%
19/11/06 01:59:41 INFO mapreduce.Job:  map 63% reduce 0%
19/11/06 01:59:42 INFO mapreduce.Job:  map 64% reduce 0%
19/11/06 01:59:44 INFO mapreduce.Job:  map 65% reduce 0%
19/11/06 01:59:45 INFO mapreduce.Job:  map 66% reduce 0%
19/11/06 01:59:46 INFO mapreduce.Job:  map 67% reduce 0%
19/11/06 01:59:47 INFO mapreduce.Job:  map 68% reduce 0%
19/11/06 01:59:48 INFO mapreduce.Job:  map 69% reduce 0%
19/11/06 01:59:50 INFO mapreduce.Job:  map 70% reduce 0%
19/11/06 01:59:52 INFO mapreduce.Job:  map 71% reduce 0%
19/11/06 01:59:54 INFO mapreduce.Job:  map 72% reduce 0%
19/11/06 01:59:55 INFO mapreduce.Job:  map 73% reduce 0%
19/11/06 01:59:57 INFO mapreduce.Job:  map 74% reduce 0%
19/11/06 01:59:58 INFO mapreduce.Job:  map 75% reduce 0%
19/11/06 02:00:00 INFO mapreduce.Job:  map 76% reduce 0%
19/11/06 02:00:01 INFO mapreduce.Job:  map 77% reduce 0%
19/11/06 02:00:03 INFO mapreduce.Job:  map 78% reduce 0%
19/11/06 02:00:04 INFO mapreduce.Job:  map 79% reduce 0%
19/11/06 02:00:05 INFO mapreduce.Job:  map 80% reduce 0%
19/11/06 02:00:07 INFO mapreduce.Job:  map 81% reduce 0%
19/11/06 02:00:08 INFO mapreduce.Job:  map 82% reduce 0%
19/11/06 02:00:10 INFO mapreduce.Job:  map 83% reduce 0%
19/11/06 02:00:11 INFO mapreduce.Job:  map 84% reduce 0%
19/11/06 02:00:12 INFO mapreduce.Job:  map 85% reduce 0%
19/11/06 02:00:14 INFO mapreduce.Job:  map 86% reduce 0%
19/11/06 02:00:16 INFO mapreduce.Job:  map 87% reduce 0%
19/11/06 02:00:18 INFO mapreduce.Job:  map 88% reduce 0%
19/11/06 02:00:20 INFO mapreduce.Job:  map 89% reduce 0%
19/11/06 02:00:21 INFO mapreduce.Job:  map 89% reduce 2%
19/11/06 02:00:22 INFO mapreduce.Job:  map 90% reduce 4%
19/11/06 02:00:23 INFO mapreduce.Job:  map 90% reduce 6%
19/11/06 02:00:24 INFO mapreduce.Job:  map 91% reduce 7%
19/11/06 02:00:25 INFO mapreduce.Job:  map 91% reduce 8%
19/11/06 02:00:27 INFO mapreduce.Job:  map 92% reduce 8%
19/11/06 02:00:28 INFO mapreduce.Job:  map 92% reduce 9%
19/11/06 02:00:29 INFO mapreduce.Job:  map 93% reduce 9%
19/11/06 02:00:30 INFO mapreduce.Job:  map 93% reduce 10%
19/11/06 02:00:31 INFO mapreduce.Job:  map 94% reduce 11%
19/11/06 02:00:33 INFO mapreduce.Job:  map 94% reduce 12%
19/11/06 02:00:34 INFO mapreduce.Job:  map 95% reduce 13%
19/11/06 02:00:36 INFO mapreduce.Job:  map 96% reduce 14%
19/11/06 02:00:37 INFO mapreduce.Job:  map 96% reduce 15%
19/11/06 02:00:38 INFO mapreduce.Job:  map 97% reduce 15%
19/11/06 02:00:39 INFO mapreduce.Job:  map 97% reduce 16%
19/11/06 02:00:40 INFO mapreduce.Job:  map 98% reduce 17%
19/11/06 02:00:42 INFO mapreduce.Job:  map 98% reduce 18%
19/11/06 02:00:43 INFO mapreduce.Job:  map 98% reduce 19%
19/11/06 02:00:44 INFO mapreduce.Job:  map 99% reduce 20%
19/11/06 02:00:45 INFO mapreduce.Job:  map 99% reduce 22%
19/11/06 02:00:46 INFO mapreduce.Job:  map 99% reduce 24%
19/11/06 02:00:47 INFO mapreduce.Job:  map 99% reduce 26%
19/11/06 02:00:48 INFO mapreduce.Job:  map 100% reduce 27%
19/11/06 02:00:49 INFO mapreduce.Job:  map 100% reduce 28%
19/11/06 02:00:50 INFO mapreduce.Job:  map 100% reduce 32%
19/11/06 02:00:52 INFO mapreduce.Job:  map 100% reduce 33%
19/11/06 02:00:56 INFO mapreduce.Job:  map 100% reduce 35%
19/11/06 02:00:57 INFO mapreduce.Job:  map 100% reduce 41%
19/11/06 02:00:58 INFO mapreduce.Job:  map 100% reduce 52%
19/11/06 02:00:59 INFO mapreduce.Job:  map 100% reduce 63%
19/11/06 02:01:00 INFO mapreduce.Job:  map 100% reduce 66%
19/11/06 02:01:01 INFO mapreduce.Job:  map 100% reduce 67%
19/11/06 02:01:02 INFO mapreduce.Job:  map 100% reduce 68%
19/11/06 02:01:04 INFO mapreduce.Job:  map 100% reduce 69%
19/11/06 02:01:06 INFO mapreduce.Job:  map 100% reduce 70%
19/11/06 02:01:08 INFO mapreduce.Job:  map 100% reduce 71%
19/11/06 02:01:10 INFO mapreduce.Job:  map 100% reduce 72%
19/11/06 02:01:12 INFO mapreduce.Job:  map 100% reduce 73%
19/11/06 02:01:14 INFO mapreduce.Job:  map 100% reduce 74%
19/11/06 02:01:16 INFO mapreduce.Job:  map 100% reduce 75%
19/11/06 02:01:18 INFO mapreduce.Job:  map 100% reduce 76%
19/11/06 02:01:20 INFO mapreduce.Job:  map 100% reduce 77%
19/11/06 02:01:22 INFO mapreduce.Job:  map 100% reduce 78%
19/11/06 02:01:24 INFO mapreduce.Job:  map 100% reduce 79%
19/11/06 02:01:26 INFO mapreduce.Job:  map 100% reduce 80%
19/11/06 02:01:28 INFO mapreduce.Job:  map 100% reduce 81%
19/11/06 02:01:30 INFO mapreduce.Job:  map 100% reduce 82%
19/11/06 02:01:31 INFO mapreduce.Job:  map 100% reduce 83%
19/11/06 02:01:33 INFO mapreduce.Job:  map 100% reduce 84%
19/11/06 02:01:35 INFO mapreduce.Job:  map 100% reduce 85%
19/11/06 02:01:37 INFO mapreduce.Job:  map 100% reduce 86%
19/11/06 02:01:39 INFO mapreduce.Job:  map 100% reduce 87%
19/11/06 02:01:40 INFO mapreduce.Job:  map 100% reduce 88%
19/11/06 02:01:42 INFO mapreduce.Job:  map 100% reduce 89%
19/11/06 02:01:44 INFO mapreduce.Job:  map 100% reduce 90%
19/11/06 02:01:46 INFO mapreduce.Job:  map 100% reduce 91%
19/11/06 02:01:48 INFO mapreduce.Job:  map 100% reduce 92%
19/11/06 02:01:51 INFO mapreduce.Job:  map 100% reduce 93%
19/11/06 02:01:53 INFO mapreduce.Job:  map 100% reduce 94%
19/11/06 02:01:55 INFO mapreduce.Job:  map 100% reduce 95%
19/11/06 02:01:59 INFO mapreduce.Job:  map 100% reduce 96%
19/11/06 02:02:02 INFO mapreduce.Job:  map 100% reduce 97%
19/11/06 02:02:07 INFO mapreduce.Job:  map 100% reduce 98%
19/11/06 02:02:13 INFO mapreduce.Job:  map 100% reduce 99%
19/11/06 02:03:07 INFO mapreduce.Job:  map 100% reduce 100%
19/11/06 02:05:15 INFO mapreduce.Job: Job job_1567079137842_610606 completed successfully
19/11/06 02:05:15 INFO mapreduce.Job: Counters: 50
	File System Counters
		FILE: Number of bytes read=18711249160
		FILE: Number of bytes written=53014908469
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=151995261223
		HDFS: Number of bytes written=201181451350
		HDFS: Number of read operations=3600
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=800
	Job Counters 
		Launched map tasks=1000
		Launched reduce tasks=200
		Data-local map tasks=959
		Rack-local map tasks=41
		Total time spent by all maps in occupied slots (ms)=298881936
		Total time spent by all reduces in occupied slots (ms)=123369420
		Total time spent by all map tasks (ms)=37360242
		Total time spent by all reduce tasks (ms)=20561570
		Total vcore-milliseconds taken by all map tasks=37360242
		Total vcore-milliseconds taken by all reduce tasks=20561570
		Total megabyte-milliseconds taken by all map tasks=153027551232
		Total megabyte-milliseconds taken by all reduce tasks=63165143040
	Map-Reduce Framework
		Map input records=71949565
		Map output records=244095853
		Map output bytes=149750967730
		Map output materialized bytes=34151543997
		Input split bytes=174000
		Combine input records=0
		Combine output records=0
		Reduce input groups=8971363
		Reduce shuffle bytes=34151543997
		Reduce input records=244095853
		Reduce output records=145469505
		Spilled Records=488191706
		Shuffled Maps =200000
		Failed Shuffles=0
		Merged Map outputs=200000
		GC time elapsed (ms)=223314
		CPU time spent (ms)=51653420
		Physical memory (bytes) snapshot=1631958343680
		Virtual memory (bytes) snapshot=6293332103168
		Total committed heap usage (bytes)=2241205895168
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=151995087223
	File Output Format Counters 
		Bytes Written=201181451350
19/11/06 02:05:15 INFO streaming.StreamJob: Output directory: /user/ad_user/ctr_space/model_train_exp/shitu/20191031/
+ judge_result hadoop_run
+ [[ 0 -ne 0 ]]
+ echo 'hadoop_run success.'
hadoop_run success.
+ ADFEA_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/adfea/
+ ADFEA_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191031/
+ INS_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/ins/
+ INS_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/ins//20191031/
+ STATINFO_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/
+ STATINFO_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191031/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191031/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191031/
19/11/06 02:05:22 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/adfea/20191031' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191031/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191031/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191031/
19/11/06 02:05:34 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/ins/20191031' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191031/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191031/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191031/
19/11/06 02:05:45 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/20191031' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191031/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191031//part-*-A' /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191031/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191031//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191031//part-*-B' /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191031/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191031//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191031//part-*-C' /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191031/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191031//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191031/
19/11/06 02:06:15 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191031' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ mylog 'task[20191031] success!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-02:06:16
+ echo '[20191106-02:06:16] task[20191031]' 'success!'
[20191106-02:06:16] task[20191031] success!
+ exit 0
+ bash -x run_shitu.sh 20191101
+ bash /home/ling.fang/kinit_ad_user.sh
+ USER_NAME=ad_user
+ HADOOP_HOME=/usr/local/hadoop-2.6.3
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ common_file=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+ source /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
++ bash /home/ling.fang/kinit_ad_user.sh
++ HADOOP_BIN=/usr/local/hadoop-2.6.3/bin/hadoop
++++ dirname /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+++ cd /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools
+++ pwd
++ ROOT_PATH=/home/work/ling.fang/personal/ling.fang/script/tools
+ '[' 1 -ge 1 ']'
+ DATE=20191101
+ '[' 1 -eq 2 ']'
+ JOB_TAG=_exp
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ INPUTDIR='-input "/user/ad_user/ctr_space/ed_join_click/join/20191101/" '
+ echo -input '"/user/ad_user/ctr_space/ed_join_click/join/20191101/"'
-input "/user/ad_user/ctr_space/ed_join_click/join/20191101/"
+ OUTPUTDIR=/user/ad_user/ctr_space/model_train_exp/shitu/20191101/
+ PLID_EDCLKDIR=/user/ad_user/ctr_space/plid_stat_info/json
+ done_file=/user/ad_user/ctr_space/ed_join_click/join/20191101/_SUCCESS
+ loop_check /user/ad_user/ctr_space/ed_join_click/join/20191101/_SUCCESS 140 1
+ file=/user/ad_user/ctr_space/ed_join_click/join/20191101/_SUCCESS
+ ready=0
+ check_time=140
+ mode=1
+ echo 'input params:/user/ad_user/ctr_space/ed_join_click/join/20191101/_SUCCESS 140 1'
input params:/user/ad_user/ctr_space/ed_join_click/join/20191101/_SUCCESS 140 1
+ '[' 3 -ne 3 ']'
+ '[' 140 -gt 0 ']'
+ '[' 1 -eq 1 ']'
+ hadoop_check_ready
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/ed_join_click/join/20191101/_SUCCESS
+ ready=1
+ '[' 1 -eq 1 ']'
+ mylog '/user/ad_user/ctr_space/ed_join_click/join/20191101/_SUCCESS is ready!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-02:06:19
+ echo '[20191106-02:06:19] /user/ad_user/ctr_space/ed_join_click/join/20191101/_SUCCESS' is 'ready!'
[20191106-02:06:19] /user/ad_user/ctr_space/ed_join_click/join/20191101/_SUCCESS is ready!
+ return 0
+ python script/get_creative_info.py
+ OWNER_INFO=ad_user@cootek.cn
+ TASK_NAME=naga_ctr_generate_shitu_log
+ hadoop_run
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191101/
rm: `/user/ad_user/ctr_space/model_train_exp/shitu/20191101/': No such file or directory
+ /usr/local/hadoop-2.6.3/bin/hadoop jar /usr/local/hadoop-2.6.3/share/hadoop/tools/lib/hadoop-streaming-2.6.3.jar -libjars /home/ling.fang/script/tools/mr_plugins-1.0.jar -files script -D map.output.key.field.separator=# -D num.key.fields.for.partition=1 -D mapreduce.map.memory.mb=4096 -D mapreduce.map.java.opts=-Xmx3276m -Dmapred.map.tasks.speculative.execution=false -Dmapred.reduce.tasks.speculative.execution=false -Dstream.non.zero.exit.is.failure=false -Dmapred.job.priority=HIGH -Dmapreduce.job.queuename=root.ad-root.etl.dailyetl.high -Dmapred.map.tasks=1000 -Dmapred.reduce.tasks=200 -Dmapred.job.map.capacity=1000 -Dmapred.job.reduce.capacity=200 -Dmapred.job.name=naga_ctr_generate_shitu_log_20191101 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -outputformat org.apache.hadoop.mapred.lib.SuffixMultipleTextOutputFormat -mapper 'python script/mapper.py' -reducer 'python script/reducer.py' -input '"/user/ad_user/ctr_space/ed_join_click/join/20191101/"' -output /user/ad_user/ctr_space/model_train_exp/shitu/20191101/
19/11/06 02:06:24 INFO Configuration.deprecation: map.output.key.field.separator is deprecated. Instead, use mapreduce.map.output.key.field.separator
19/11/06 02:06:24 INFO Configuration.deprecation: mapred.map.tasks.speculative.execution is deprecated. Instead, use mapreduce.map.speculative
19/11/06 02:06:24 INFO Configuration.deprecation: mapred.reduce.tasks.speculative.execution is deprecated. Instead, use mapreduce.reduce.speculative
19/11/06 02:06:24 INFO Configuration.deprecation: mapred.job.priority is deprecated. Instead, use mapreduce.job.priority
19/11/06 02:06:24 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
19/11/06 02:06:24 INFO Configuration.deprecation: mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces
19/11/06 02:06:24 INFO Configuration.deprecation: mapred.job.name is deprecated. Instead, use mapreduce.job.name
packageJobJar: [/tmp/hadoop-unjar2700861378313018185/] [] /tmp/streamjob865276934263378875.jar tmpDir=null
19/11/06 02:06:25 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 02:06:25 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 02:06:25 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 4046622 for ad_user on ha-hdfs:cootek
19/11/06 02:06:26 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046622 for ad_user)
19/11/06 02:06:26 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 02:06:26 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c bf 14 af 8a 01 6e 60 cb 98 af 8d 31 03 4d 8e 02 7f
19/11/06 02:06:32 INFO lzo.GPLNativeCodeLoader: Loaded native gpl library from the embedded binaries
19/11/06 02:06:32 INFO lzo.LzoCodec: Successfully loaded & initialized native-lzo library [hadoop-lzo rev 52decc77982b58949890770d22720a91adce0c3f]
19/11/06 02:06:32 INFO mapred.FileInputFormat: Total input paths to process : 1000
19/11/06 02:06:32 INFO mapreduce.JobSubmitter: number of splits:1000
19/11/06 02:06:32 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1567079137842_610709
19/11/06 02:06:32 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046622 for ad_user)
19/11/06 02:06:32 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 02:06:32 WARN token.Token: Cannot find class for token kind kms-dt
Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c bf 14 af 8a 01 6e 60 cb 98 af 8d 31 03 4d 8e 02 7f
19/11/06 02:06:33 INFO impl.YarnClientImpl: Submitted application application_1567079137842_610709
19/11/06 02:06:33 INFO mapreduce.Job: The url to track the job: http://hadoop2-namenode.corp.cootek.com:8088/proxy/application_1567079137842_610709/
19/11/06 02:06:33 INFO mapreduce.Job: Running job: job_1567079137842_610709
19/11/06 02:10:03 INFO mapreduce.Job: Job job_1567079137842_610709 running in uber mode : false
19/11/06 02:10:03 INFO mapreduce.Job:  map 0% reduce 0%
19/11/06 02:10:57 INFO mapreduce.Job:  map 1% reduce 0%
19/11/06 02:11:00 INFO mapreduce.Job:  map 2% reduce 0%
19/11/06 02:11:03 INFO mapreduce.Job:  map 3% reduce 0%
19/11/06 02:11:05 INFO mapreduce.Job:  map 4% reduce 0%
19/11/06 02:11:08 INFO mapreduce.Job:  map 5% reduce 0%
19/11/06 02:11:10 INFO mapreduce.Job:  map 6% reduce 0%
19/11/06 02:11:11 INFO mapreduce.Job:  map 7% reduce 0%
19/11/06 02:11:14 INFO mapreduce.Job:  map 8% reduce 0%
19/11/06 02:11:15 INFO mapreduce.Job:  map 9% reduce 0%
19/11/06 02:11:17 INFO mapreduce.Job:  map 10% reduce 0%
19/11/06 02:11:18 INFO mapreduce.Job:  map 11% reduce 0%
19/11/06 02:11:20 INFO mapreduce.Job:  map 13% reduce 0%
19/11/06 02:11:22 INFO mapreduce.Job:  map 14% reduce 0%
19/11/06 02:11:23 INFO mapreduce.Job:  map 15% reduce 0%
19/11/06 02:11:24 INFO mapreduce.Job:  map 16% reduce 0%
19/11/06 02:11:25 INFO mapreduce.Job:  map 17% reduce 0%
19/11/06 02:11:26 INFO mapreduce.Job:  map 18% reduce 0%
19/11/06 02:11:27 INFO mapreduce.Job:  map 19% reduce 0%
19/11/06 02:11:29 INFO mapreduce.Job:  map 20% reduce 0%
19/11/06 02:11:31 INFO mapreduce.Job:  map 21% reduce 0%
19/11/06 02:11:32 INFO mapreduce.Job:  map 22% reduce 0%
19/11/06 02:11:34 INFO mapreduce.Job:  map 23% reduce 0%
19/11/06 02:11:36 INFO mapreduce.Job:  map 24% reduce 0%
19/11/06 02:11:38 INFO mapreduce.Job:  map 25% reduce 0%
19/11/06 02:11:40 INFO mapreduce.Job:  map 26% reduce 0%
19/11/06 02:11:42 INFO mapreduce.Job:  map 27% reduce 0%
19/11/06 02:11:44 INFO mapreduce.Job:  map 28% reduce 0%
19/11/06 02:11:47 INFO mapreduce.Job:  map 29% reduce 0%
19/11/06 02:11:50 INFO mapreduce.Job:  map 30% reduce 0%
19/11/06 02:11:51 INFO mapreduce.Job:  map 31% reduce 0%
19/11/06 02:11:53 INFO mapreduce.Job:  map 32% reduce 0%
19/11/06 02:11:54 INFO mapreduce.Job:  map 33% reduce 0%
19/11/06 02:11:55 INFO mapreduce.Job:  map 34% reduce 0%
19/11/06 02:11:57 INFO mapreduce.Job:  map 35% reduce 0%
19/11/06 02:11:59 INFO mapreduce.Job:  map 36% reduce 0%
19/11/06 02:12:00 INFO mapreduce.Job:  map 37% reduce 0%
19/11/06 02:12:01 INFO mapreduce.Job:  map 38% reduce 0%
19/11/06 02:12:03 INFO mapreduce.Job:  map 39% reduce 0%
19/11/06 02:12:05 INFO mapreduce.Job:  map 40% reduce 0%
19/11/06 02:12:06 INFO mapreduce.Job:  map 41% reduce 0%
19/11/06 02:12:07 INFO mapreduce.Job:  map 42% reduce 0%
19/11/06 02:12:09 INFO mapreduce.Job:  map 43% reduce 0%
19/11/06 02:12:10 INFO mapreduce.Job:  map 44% reduce 0%
19/11/06 02:12:12 INFO mapreduce.Job:  map 45% reduce 0%
19/11/06 02:12:13 INFO mapreduce.Job:  map 46% reduce 0%
19/11/06 02:12:14 INFO mapreduce.Job:  map 47% reduce 0%
19/11/06 02:12:15 INFO mapreduce.Job:  map 48% reduce 0%
19/11/06 02:12:16 INFO mapreduce.Job:  map 49% reduce 0%
19/11/06 02:12:18 INFO mapreduce.Job:  map 50% reduce 0%
19/11/06 02:12:19 INFO mapreduce.Job:  map 51% reduce 0%
19/11/06 02:12:21 INFO mapreduce.Job:  map 52% reduce 0%
19/11/06 02:12:23 INFO mapreduce.Job:  map 53% reduce 0%
19/11/06 02:12:25 INFO mapreduce.Job:  map 54% reduce 0%
19/11/06 02:12:27 INFO mapreduce.Job:  map 55% reduce 0%
19/11/06 02:12:28 INFO mapreduce.Job:  map 56% reduce 0%
19/11/06 02:12:30 INFO mapreduce.Job:  map 57% reduce 0%
19/11/06 02:12:32 INFO mapreduce.Job:  map 58% reduce 0%
19/11/06 02:12:33 INFO mapreduce.Job:  map 59% reduce 0%
19/11/06 02:12:35 INFO mapreduce.Job:  map 60% reduce 0%
19/11/06 02:12:36 INFO mapreduce.Job:  map 61% reduce 0%
19/11/06 02:12:38 INFO mapreduce.Job:  map 62% reduce 0%
19/11/06 02:12:40 INFO mapreduce.Job:  map 63% reduce 0%
19/11/06 02:12:41 INFO mapreduce.Job:  map 64% reduce 0%
19/11/06 02:12:42 INFO mapreduce.Job:  map 65% reduce 0%
19/11/06 02:12:44 INFO mapreduce.Job:  map 66% reduce 0%
19/11/06 02:12:45 INFO mapreduce.Job:  map 67% reduce 0%
19/11/06 02:12:46 INFO mapreduce.Job:  map 68% reduce 0%
19/11/06 02:12:48 INFO mapreduce.Job:  map 69% reduce 0%
19/11/06 02:12:49 INFO mapreduce.Job:  map 70% reduce 0%
19/11/06 02:12:50 INFO mapreduce.Job:  map 71% reduce 0%
19/11/06 02:12:51 INFO mapreduce.Job:  map 72% reduce 0%
19/11/06 02:12:52 INFO mapreduce.Job:  map 73% reduce 0%
19/11/06 02:12:54 INFO mapreduce.Job:  map 74% reduce 0%
19/11/06 02:12:56 INFO mapreduce.Job:  map 75% reduce 0%
19/11/06 02:12:58 INFO mapreduce.Job:  map 76% reduce 0%
19/11/06 02:13:00 INFO mapreduce.Job:  map 77% reduce 0%
19/11/06 02:13:01 INFO mapreduce.Job:  map 78% reduce 0%
19/11/06 02:13:02 INFO mapreduce.Job:  map 79% reduce 0%
19/11/06 02:13:04 INFO mapreduce.Job:  map 80% reduce 0%
19/11/06 02:13:05 INFO mapreduce.Job:  map 81% reduce 0%
19/11/06 02:13:06 INFO mapreduce.Job:  map 82% reduce 0%
19/11/06 02:13:08 INFO mapreduce.Job:  map 83% reduce 0%
19/11/06 02:13:09 INFO mapreduce.Job:  map 84% reduce 0%
19/11/06 02:13:11 INFO mapreduce.Job:  map 85% reduce 0%
19/11/06 02:13:12 INFO mapreduce.Job:  map 86% reduce 0%
19/11/06 02:13:13 INFO mapreduce.Job:  map 87% reduce 0%
19/11/06 02:13:15 INFO mapreduce.Job:  map 88% reduce 0%
19/11/06 02:13:16 INFO mapreduce.Job:  map 89% reduce 0%
19/11/06 02:13:18 INFO mapreduce.Job:  map 90% reduce 0%
19/11/06 02:13:20 INFO mapreduce.Job:  map 91% reduce 0%
19/11/06 02:13:21 INFO mapreduce.Job:  map 92% reduce 0%
19/11/06 02:13:23 INFO mapreduce.Job:  map 93% reduce 0%
19/11/06 02:13:24 INFO mapreduce.Job:  map 94% reduce 2%
19/11/06 02:13:25 INFO mapreduce.Job:  map 94% reduce 3%
19/11/06 02:13:26 INFO mapreduce.Job:  map 95% reduce 4%
19/11/06 02:13:27 INFO mapreduce.Job:  map 95% reduce 7%
19/11/06 02:13:28 INFO mapreduce.Job:  map 96% reduce 9%
19/11/06 02:13:29 INFO mapreduce.Job:  map 96% reduce 11%
19/11/06 02:13:30 INFO mapreduce.Job:  map 97% reduce 13%
19/11/06 02:13:31 INFO mapreduce.Job:  map 97% reduce 15%
19/11/06 02:13:32 INFO mapreduce.Job:  map 98% reduce 18%
19/11/06 02:13:33 INFO mapreduce.Job:  map 98% reduce 21%
19/11/06 02:13:34 INFO mapreduce.Job:  map 98% reduce 22%
19/11/06 02:13:35 INFO mapreduce.Job:  map 99% reduce 24%
19/11/06 02:13:36 INFO mapreduce.Job:  map 99% reduce 26%
19/11/06 02:13:37 INFO mapreduce.Job:  map 99% reduce 29%
19/11/06 02:13:38 INFO mapreduce.Job:  map 99% reduce 30%
19/11/06 02:13:39 INFO mapreduce.Job:  map 99% reduce 32%
19/11/06 02:13:40 INFO mapreduce.Job:  map 100% reduce 33%
19/11/06 02:24:25 INFO mapreduce.Job:  map 100% reduce 36%
19/11/06 02:24:26 INFO mapreduce.Job:  map 100% reduce 42%
19/11/06 02:24:27 INFO mapreduce.Job:  map 100% reduce 54%
19/11/06 02:24:28 INFO mapreduce.Job:  map 100% reduce 63%
19/11/06 02:24:29 INFO mapreduce.Job:  map 100% reduce 66%
19/11/06 02:24:30 INFO mapreduce.Job:  map 100% reduce 67%
19/11/06 02:24:31 INFO mapreduce.Job:  map 100% reduce 68%
19/11/06 02:24:33 INFO mapreduce.Job:  map 100% reduce 69%
19/11/06 02:24:34 INFO mapreduce.Job:  map 100% reduce 70%
19/11/06 02:24:36 INFO mapreduce.Job:  map 100% reduce 71%
19/11/06 02:24:38 INFO mapreduce.Job:  map 100% reduce 72%
19/11/06 02:24:40 INFO mapreduce.Job:  map 100% reduce 73%
19/11/06 02:24:42 INFO mapreduce.Job:  map 100% reduce 74%
19/11/06 02:24:44 INFO mapreduce.Job:  map 100% reduce 75%
19/11/06 02:24:45 INFO mapreduce.Job:  map 100% reduce 76%
19/11/06 02:24:47 INFO mapreduce.Job:  map 100% reduce 77%
19/11/06 02:24:49 INFO mapreduce.Job:  map 100% reduce 78%
19/11/06 02:24:51 INFO mapreduce.Job:  map 100% reduce 79%
19/11/06 02:24:53 INFO mapreduce.Job:  map 100% reduce 80%
19/11/06 02:24:56 INFO mapreduce.Job:  map 100% reduce 81%
19/11/06 02:24:57 INFO mapreduce.Job:  map 100% reduce 82%
19/11/06 02:24:59 INFO mapreduce.Job:  map 100% reduce 83%
19/11/06 02:25:01 INFO mapreduce.Job:  map 100% reduce 84%
19/11/06 02:25:03 INFO mapreduce.Job:  map 100% reduce 85%
19/11/06 02:25:05 INFO mapreduce.Job:  map 100% reduce 86%
19/11/06 02:25:07 INFO mapreduce.Job:  map 100% reduce 87%
19/11/06 02:25:09 INFO mapreduce.Job:  map 100% reduce 88%
19/11/06 02:25:11 INFO mapreduce.Job:  map 100% reduce 89%
19/11/06 02:25:13 INFO mapreduce.Job:  map 100% reduce 90%
19/11/06 02:25:15 INFO mapreduce.Job:  map 100% reduce 91%
19/11/06 02:25:17 INFO mapreduce.Job:  map 100% reduce 92%
19/11/06 02:25:19 INFO mapreduce.Job:  map 100% reduce 93%
19/11/06 02:25:22 INFO mapreduce.Job:  map 100% reduce 94%
19/11/06 02:25:24 INFO mapreduce.Job:  map 100% reduce 95%
19/11/06 02:25:28 INFO mapreduce.Job:  map 100% reduce 96%
19/11/06 02:25:33 INFO mapreduce.Job:  map 100% reduce 97%
19/11/06 02:25:38 INFO mapreduce.Job:  map 100% reduce 98%
19/11/06 02:25:45 INFO mapreduce.Job:  map 100% reduce 99%
19/11/06 02:26:00 INFO mapreduce.Job:  map 100% reduce 100%
19/11/06 02:26:30 INFO mapreduce.Job: Job job_1567079137842_610709 completed successfully
19/11/06 02:26:30 INFO mapreduce.Job: Counters: 50
	File System Counters
		FILE: Number of bytes read=17278860575
		FILE: Number of bytes written=48753002025
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=145598385667
		HDFS: Number of bytes written=192872685399
		HDFS: Number of read operations=3600
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=800
	Job Counters 
		Launched map tasks=1000
		Launched reduce tasks=200
		Data-local map tasks=962
		Rack-local map tasks=38
		Total time spent by all maps in occupied slots (ms)=303737384
		Total time spent by all reduces in occupied slots (ms)=874305096
		Total time spent by all map tasks (ms)=37967173
		Total time spent by all reduce tasks (ms)=145717516
		Total vcore-milliseconds taken by all map tasks=37967173
		Total vcore-milliseconds taken by all reduce tasks=145717516
		Total megabyte-milliseconds taken by all map tasks=155513540608
		Total megabyte-milliseconds taken by all reduce tasks=447644209152
	Map-Reduce Framework
		Map input records=69089387
		Map output records=215604953
		Map output bytes=142525326446
		Map output materialized bytes=31322028202
		Input split bytes=174000
		Combine input records=0
		Combine output records=0
		Reduce input groups=8265635
		Reduce shuffle bytes=31322028202
		Reduce input records=215604953
		Reduce output records=139495435
		Spilled Records=431209906
		Shuffled Maps =200000
		Failed Shuffles=0
		Merged Map outputs=200000
		GC time elapsed (ms)=385403
		CPU time spent (ms)=56937880
		Physical memory (bytes) snapshot=1620882354176
		Virtual memory (bytes) snapshot=6294605746176
		Total committed heap usage (bytes)=2223603449856
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=145598211667
	File Output Format Counters 
		Bytes Written=192872685399
19/11/06 02:26:30 INFO streaming.StreamJob: Output directory: /user/ad_user/ctr_space/model_train_exp/shitu/20191101/
+ judge_result hadoop_run
+ [[ 0 -ne 0 ]]
+ echo 'hadoop_run success.'
hadoop_run success.
+ ADFEA_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/adfea/
+ ADFEA_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191101/
+ INS_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/ins/
+ INS_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/ins//20191101/
+ STATINFO_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/
+ STATINFO_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191101/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191101/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191101/
19/11/06 02:26:36 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/adfea/20191101' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191101/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191101/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191101/
19/11/06 02:26:45 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/ins/20191101' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191101/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191101/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191101/
19/11/06 02:26:55 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/20191101' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191101/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191101//part-*-A' /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191101/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191101//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191101//part-*-B' /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191101/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191101//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191101//part-*-C' /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191101/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191101//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191101/
19/11/06 02:27:40 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191101' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ mylog 'task[20191101] success!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-02:27:50
+ echo '[20191106-02:27:50] task[20191101]' 'success!'
[20191106-02:27:50] task[20191101] success!
+ exit 0
+ bash -x run_shitu.sh 20191102
+ bash /home/ling.fang/kinit_ad_user.sh
+ USER_NAME=ad_user
+ HADOOP_HOME=/usr/local/hadoop-2.6.3
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ common_file=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+ source /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
++ bash /home/ling.fang/kinit_ad_user.sh
++ HADOOP_BIN=/usr/local/hadoop-2.6.3/bin/hadoop
++++ dirname /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+++ cd /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools
+++ pwd
++ ROOT_PATH=/home/work/ling.fang/personal/ling.fang/script/tools
+ '[' 1 -ge 1 ']'
+ DATE=20191102
+ '[' 1 -eq 2 ']'
+ JOB_TAG=_exp
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ INPUTDIR='-input "/user/ad_user/ctr_space/ed_join_click/join/20191102/" '
+ echo -input '"/user/ad_user/ctr_space/ed_join_click/join/20191102/"'
-input "/user/ad_user/ctr_space/ed_join_click/join/20191102/"
+ OUTPUTDIR=/user/ad_user/ctr_space/model_train_exp/shitu/20191102/
+ PLID_EDCLKDIR=/user/ad_user/ctr_space/plid_stat_info/json
+ done_file=/user/ad_user/ctr_space/ed_join_click/join/20191102/_SUCCESS
+ loop_check /user/ad_user/ctr_space/ed_join_click/join/20191102/_SUCCESS 140 1
+ file=/user/ad_user/ctr_space/ed_join_click/join/20191102/_SUCCESS
+ ready=0
+ check_time=140
+ mode=1
+ echo 'input params:/user/ad_user/ctr_space/ed_join_click/join/20191102/_SUCCESS 140 1'
input params:/user/ad_user/ctr_space/ed_join_click/join/20191102/_SUCCESS 140 1
+ '[' 3 -ne 3 ']'
+ '[' 140 -gt 0 ']'
+ '[' 1 -eq 1 ']'
+ hadoop_check_ready
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/ed_join_click/join/20191102/_SUCCESS
+ ready=1
+ '[' 1 -eq 1 ']'
+ mylog '/user/ad_user/ctr_space/ed_join_click/join/20191102/_SUCCESS is ready!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-02:27:53
+ echo '[20191106-02:27:53] /user/ad_user/ctr_space/ed_join_click/join/20191102/_SUCCESS' is 'ready!'
[20191106-02:27:53] /user/ad_user/ctr_space/ed_join_click/join/20191102/_SUCCESS is ready!
+ return 0
+ python script/get_creative_info.py
+ OWNER_INFO=ad_user@cootek.cn
+ TASK_NAME=naga_ctr_generate_shitu_log
+ hadoop_run
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191102/
rm: `/user/ad_user/ctr_space/model_train_exp/shitu/20191102/': No such file or directory
+ /usr/local/hadoop-2.6.3/bin/hadoop jar /usr/local/hadoop-2.6.3/share/hadoop/tools/lib/hadoop-streaming-2.6.3.jar -libjars /home/ling.fang/script/tools/mr_plugins-1.0.jar -files script -D map.output.key.field.separator=# -D num.key.fields.for.partition=1 -D mapreduce.map.memory.mb=4096 -D mapreduce.map.java.opts=-Xmx3276m -Dmapred.map.tasks.speculative.execution=false -Dmapred.reduce.tasks.speculative.execution=false -Dstream.non.zero.exit.is.failure=false -Dmapred.job.priority=HIGH -Dmapreduce.job.queuename=root.ad-root.etl.dailyetl.high -Dmapred.map.tasks=1000 -Dmapred.reduce.tasks=200 -Dmapred.job.map.capacity=1000 -Dmapred.job.reduce.capacity=200 -Dmapred.job.name=naga_ctr_generate_shitu_log_20191102 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -outputformat org.apache.hadoop.mapred.lib.SuffixMultipleTextOutputFormat -mapper 'python script/mapper.py' -reducer 'python script/reducer.py' -input '"/user/ad_user/ctr_space/ed_join_click/join/20191102/"' -output /user/ad_user/ctr_space/model_train_exp/shitu/20191102/
19/11/06 02:27:58 INFO Configuration.deprecation: map.output.key.field.separator is deprecated. Instead, use mapreduce.map.output.key.field.separator
19/11/06 02:27:58 INFO Configuration.deprecation: mapred.map.tasks.speculative.execution is deprecated. Instead, use mapreduce.map.speculative
19/11/06 02:27:58 INFO Configuration.deprecation: mapred.reduce.tasks.speculative.execution is deprecated. Instead, use mapreduce.reduce.speculative
19/11/06 02:27:58 INFO Configuration.deprecation: mapred.job.priority is deprecated. Instead, use mapreduce.job.priority
19/11/06 02:27:58 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
19/11/06 02:27:58 INFO Configuration.deprecation: mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces
19/11/06 02:27:58 INFO Configuration.deprecation: mapred.job.name is deprecated. Instead, use mapreduce.job.name
packageJobJar: [/tmp/hadoop-unjar7293428468526827551/] [] /tmp/streamjob2852496737907736859.jar tmpDir=null
19/11/06 02:27:59 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 02:27:59 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 02:27:59 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 4046833 for ad_user on ha-hdfs:cootek
19/11/06 02:27:59 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046833 for ad_user)
19/11/06 02:27:59 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 02:27:59 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c d2 d2 3e 8a 01 6e 60 df 56 3e 8d 31 04 1e 8e 02 7f
19/11/06 02:28:05 INFO lzo.GPLNativeCodeLoader: Loaded native gpl library from the embedded binaries
19/11/06 02:28:05 INFO lzo.LzoCodec: Successfully loaded & initialized native-lzo library [hadoop-lzo rev 52decc77982b58949890770d22720a91adce0c3f]
19/11/06 02:28:05 INFO mapred.FileInputFormat: Total input paths to process : 1000
19/11/06 02:28:06 INFO mapreduce.JobSubmitter: number of splits:1000
19/11/06 02:28:07 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1567079137842_610852
19/11/06 02:28:07 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046833 for ad_user)
19/11/06 02:28:07 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 02:28:07 WARN token.Token: Cannot find class for token kind kms-dt
Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c d2 d2 3e 8a 01 6e 60 df 56 3e 8d 31 04 1e 8e 02 7f
19/11/06 02:28:07 INFO impl.YarnClientImpl: Submitted application application_1567079137842_610852
19/11/06 02:28:07 INFO mapreduce.Job: The url to track the job: http://hadoop2-namenode.corp.cootek.com:8088/proxy/application_1567079137842_610852/
19/11/06 02:28:07 INFO mapreduce.Job: Running job: job_1567079137842_610852
19/11/06 02:29:11 INFO mapreduce.Job: Job job_1567079137842_610852 running in uber mode : false
19/11/06 02:29:11 INFO mapreduce.Job:  map 0% reduce 0%
19/11/06 02:30:06 INFO mapreduce.Job:  map 1% reduce 0%
19/11/06 02:30:19 INFO mapreduce.Job:  map 2% reduce 0%
19/11/06 02:30:26 INFO mapreduce.Job:  map 3% reduce 0%
19/11/06 02:30:33 INFO mapreduce.Job:  map 4% reduce 0%
19/11/06 02:30:35 INFO mapreduce.Job:  map 5% reduce 0%
19/11/06 02:30:38 INFO mapreduce.Job:  map 6% reduce 0%
19/11/06 02:30:40 INFO mapreduce.Job:  map 7% reduce 0%
19/11/06 02:30:42 INFO mapreduce.Job:  map 8% reduce 0%
19/11/06 02:30:44 INFO mapreduce.Job:  map 9% reduce 0%
19/11/06 02:30:46 INFO mapreduce.Job:  map 10% reduce 0%
19/11/06 02:30:49 INFO mapreduce.Job:  map 11% reduce 0%
19/11/06 02:30:51 INFO mapreduce.Job:  map 12% reduce 0%
19/11/06 02:30:53 INFO mapreduce.Job:  map 13% reduce 0%
19/11/06 02:30:56 INFO mapreduce.Job:  map 14% reduce 0%
19/11/06 02:30:58 INFO mapreduce.Job:  map 15% reduce 0%
19/11/06 02:30:59 INFO mapreduce.Job:  map 16% reduce 0%
19/11/06 02:31:00 INFO mapreduce.Job:  map 17% reduce 0%
19/11/06 02:31:02 INFO mapreduce.Job:  map 18% reduce 0%
19/11/06 02:31:03 INFO mapreduce.Job:  map 19% reduce 0%
19/11/06 02:31:04 INFO mapreduce.Job:  map 20% reduce 0%
19/11/06 02:31:06 INFO mapreduce.Job:  map 21% reduce 0%
19/11/06 02:31:10 INFO mapreduce.Job:  map 22% reduce 0%
19/11/06 02:31:12 INFO mapreduce.Job:  map 23% reduce 0%
19/11/06 02:31:15 INFO mapreduce.Job:  map 24% reduce 0%
19/11/06 02:31:16 INFO mapreduce.Job:  map 25% reduce 0%
19/11/06 02:31:18 INFO mapreduce.Job:  map 26% reduce 0%
19/11/06 02:31:20 INFO mapreduce.Job:  map 27% reduce 0%
19/11/06 02:31:22 INFO mapreduce.Job:  map 28% reduce 0%
19/11/06 02:31:24 INFO mapreduce.Job:  map 29% reduce 0%
19/11/06 02:31:26 INFO mapreduce.Job:  map 30% reduce 0%
19/11/06 02:31:29 INFO mapreduce.Job:  map 31% reduce 0%
19/11/06 02:31:31 INFO mapreduce.Job:  map 32% reduce 0%
19/11/06 02:31:33 INFO mapreduce.Job:  map 33% reduce 0%
19/11/06 02:31:34 INFO mapreduce.Job:  map 34% reduce 0%
19/11/06 02:31:36 INFO mapreduce.Job:  map 35% reduce 0%
19/11/06 02:31:37 INFO mapreduce.Job:  map 36% reduce 0%
19/11/06 02:31:39 INFO mapreduce.Job:  map 37% reduce 0%
19/11/06 02:31:41 INFO mapreduce.Job:  map 38% reduce 0%
19/11/06 02:31:42 INFO mapreduce.Job:  map 39% reduce 0%
19/11/06 02:31:45 INFO mapreduce.Job:  map 40% reduce 0%
19/11/06 02:31:48 INFO mapreduce.Job:  map 41% reduce 0%
19/11/06 02:31:50 INFO mapreduce.Job:  map 42% reduce 0%
19/11/06 02:31:51 INFO mapreduce.Job:  map 43% reduce 0%
19/11/06 02:31:53 INFO mapreduce.Job:  map 44% reduce 0%
19/11/06 02:31:54 INFO mapreduce.Job:  map 45% reduce 0%
19/11/06 02:31:56 INFO mapreduce.Job:  map 46% reduce 0%
19/11/06 02:31:58 INFO mapreduce.Job:  map 47% reduce 0%
19/11/06 02:31:59 INFO mapreduce.Job:  map 48% reduce 0%
19/11/06 02:32:01 INFO mapreduce.Job:  map 49% reduce 0%
19/11/06 02:32:02 INFO mapreduce.Job:  map 50% reduce 0%
19/11/06 02:32:04 INFO mapreduce.Job:  map 51% reduce 0%
19/11/06 02:32:05 INFO mapreduce.Job:  map 52% reduce 0%
19/11/06 02:32:07 INFO mapreduce.Job:  map 53% reduce 0%
19/11/06 02:32:08 INFO mapreduce.Job:  map 54% reduce 0%
19/11/06 02:32:10 INFO mapreduce.Job:  map 55% reduce 0%
19/11/06 02:32:11 INFO mapreduce.Job:  map 56% reduce 0%
19/11/06 02:32:12 INFO mapreduce.Job:  map 57% reduce 0%
19/11/06 02:32:13 INFO mapreduce.Job:  map 58% reduce 0%
19/11/06 02:32:14 INFO mapreduce.Job:  map 59% reduce 0%
19/11/06 02:32:16 INFO mapreduce.Job:  map 60% reduce 0%
19/11/06 02:32:17 INFO mapreduce.Job:  map 61% reduce 0%
19/11/06 02:32:18 INFO mapreduce.Job:  map 62% reduce 0%
19/11/06 02:32:19 INFO mapreduce.Job:  map 63% reduce 0%
19/11/06 02:32:20 INFO mapreduce.Job:  map 64% reduce 0%
19/11/06 02:32:21 INFO mapreduce.Job:  map 65% reduce 0%
19/11/06 02:32:23 INFO mapreduce.Job:  map 66% reduce 0%
19/11/06 02:32:25 INFO mapreduce.Job:  map 67% reduce 0%
19/11/06 02:32:26 INFO mapreduce.Job:  map 68% reduce 0%
19/11/06 02:32:28 INFO mapreduce.Job:  map 69% reduce 0%
19/11/06 02:32:29 INFO mapreduce.Job:  map 70% reduce 0%
19/11/06 02:32:31 INFO mapreduce.Job:  map 71% reduce 0%
19/11/06 02:32:33 INFO mapreduce.Job:  map 72% reduce 0%
19/11/06 02:32:35 INFO mapreduce.Job:  map 73% reduce 0%
19/11/06 02:32:36 INFO mapreduce.Job:  map 74% reduce 0%
19/11/06 02:32:38 INFO mapreduce.Job:  map 75% reduce 0%
19/11/06 02:32:39 INFO mapreduce.Job:  map 76% reduce 0%
19/11/06 02:32:40 INFO mapreduce.Job:  map 77% reduce 0%
19/11/06 02:32:42 INFO mapreduce.Job:  map 78% reduce 0%
19/11/06 02:32:44 INFO mapreduce.Job:  map 79% reduce 0%
19/11/06 02:32:46 INFO mapreduce.Job:  map 80% reduce 0%
19/11/06 02:32:48 INFO mapreduce.Job:  map 81% reduce 0%
19/11/06 02:32:49 INFO mapreduce.Job:  map 82% reduce 0%
19/11/06 02:32:51 INFO mapreduce.Job:  map 83% reduce 0%
19/11/06 02:32:52 INFO mapreduce.Job:  map 84% reduce 0%
19/11/06 02:32:53 INFO mapreduce.Job:  map 85% reduce 0%
19/11/06 02:32:54 INFO mapreduce.Job:  map 86% reduce 0%
19/11/06 02:32:56 INFO mapreduce.Job:  map 87% reduce 0%
19/11/06 02:32:57 INFO mapreduce.Job:  map 89% reduce 0%
19/11/06 02:32:59 INFO mapreduce.Job:  map 90% reduce 0%
19/11/06 02:33:00 INFO mapreduce.Job:  map 91% reduce 0%
19/11/06 02:33:01 INFO mapreduce.Job:  map 92% reduce 0%
19/11/06 02:33:02 INFO mapreduce.Job:  map 93% reduce 0%
19/11/06 02:33:04 INFO mapreduce.Job:  map 94% reduce 0%
19/11/06 02:33:06 INFO mapreduce.Job:  map 95% reduce 0%
19/11/06 02:33:09 INFO mapreduce.Job:  map 96% reduce 1%
19/11/06 02:33:12 INFO mapreduce.Job:  map 97% reduce 2%
19/11/06 02:33:13 INFO mapreduce.Job:  map 97% reduce 4%
19/11/06 02:33:14 INFO mapreduce.Job:  map 97% reduce 5%
19/11/06 02:33:15 INFO mapreduce.Job:  map 97% reduce 8%
19/11/06 02:33:16 INFO mapreduce.Job:  map 98% reduce 9%
19/11/06 02:33:17 INFO mapreduce.Job:  map 98% reduce 11%
19/11/06 02:33:18 INFO mapreduce.Job:  map 98% reduce 13%
19/11/06 02:33:19 INFO mapreduce.Job:  map 98% reduce 15%
19/11/06 02:33:21 INFO mapreduce.Job:  map 98% reduce 16%
19/11/06 02:33:22 INFO mapreduce.Job:  map 98% reduce 17%
19/11/06 02:33:23 INFO mapreduce.Job:  map 99% reduce 19%
19/11/06 02:33:25 INFO mapreduce.Job:  map 99% reduce 21%
19/11/06 02:33:26 INFO mapreduce.Job:  map 99% reduce 22%
19/11/06 02:33:29 INFO mapreduce.Job:  map 99% reduce 23%
19/11/06 02:33:32 INFO mapreduce.Job:  map 100% reduce 23%
19/11/06 02:33:33 INFO mapreduce.Job:  map 100% reduce 24%
19/11/06 02:33:34 INFO mapreduce.Job:  map 100% reduce 25%
19/11/06 02:33:35 INFO mapreduce.Job:  map 100% reduce 26%
19/11/06 02:33:37 INFO mapreduce.Job:  map 100% reduce 27%
19/11/06 02:33:39 INFO mapreduce.Job:  map 100% reduce 29%
19/11/06 02:33:41 INFO mapreduce.Job:  map 100% reduce 30%
19/11/06 02:33:44 INFO mapreduce.Job:  map 100% reduce 37%
19/11/06 02:33:45 INFO mapreduce.Job:  map 100% reduce 45%
19/11/06 02:33:46 INFO mapreduce.Job:  map 100% reduce 56%
19/11/06 02:33:47 INFO mapreduce.Job:  map 100% reduce 63%
19/11/06 02:33:48 INFO mapreduce.Job:  map 100% reduce 66%
19/11/06 02:33:49 INFO mapreduce.Job:  map 100% reduce 67%
19/11/06 02:33:50 INFO mapreduce.Job:  map 100% reduce 68%
19/11/06 02:33:51 INFO mapreduce.Job:  map 100% reduce 69%
19/11/06 02:33:53 INFO mapreduce.Job:  map 100% reduce 70%
19/11/06 02:33:55 INFO mapreduce.Job:  map 100% reduce 71%
19/11/06 02:33:56 INFO mapreduce.Job:  map 100% reduce 72%
19/11/06 02:33:58 INFO mapreduce.Job:  map 100% reduce 73%
19/11/06 02:34:00 INFO mapreduce.Job:  map 100% reduce 74%
19/11/06 02:34:02 INFO mapreduce.Job:  map 100% reduce 75%
19/11/06 02:34:04 INFO mapreduce.Job:  map 100% reduce 76%
19/11/06 02:34:06 INFO mapreduce.Job:  map 100% reduce 77%
19/11/06 02:34:08 INFO mapreduce.Job:  map 100% reduce 78%
19/11/06 02:34:10 INFO mapreduce.Job:  map 100% reduce 79%
19/11/06 02:34:12 INFO mapreduce.Job:  map 100% reduce 80%
19/11/06 02:34:14 INFO mapreduce.Job:  map 100% reduce 81%
19/11/06 02:34:16 INFO mapreduce.Job:  map 100% reduce 82%
19/11/06 02:34:18 INFO mapreduce.Job:  map 100% reduce 83%
19/11/06 02:34:20 INFO mapreduce.Job:  map 100% reduce 84%
19/11/06 02:34:23 INFO mapreduce.Job:  map 100% reduce 85%
19/11/06 02:34:26 INFO mapreduce.Job:  map 100% reduce 86%
19/11/06 02:34:28 INFO mapreduce.Job:  map 100% reduce 87%
19/11/06 02:34:30 INFO mapreduce.Job:  map 100% reduce 88%
19/11/06 02:34:32 INFO mapreduce.Job:  map 100% reduce 89%
19/11/06 02:34:34 INFO mapreduce.Job:  map 100% reduce 90%
19/11/06 02:34:36 INFO mapreduce.Job:  map 100% reduce 91%
19/11/06 02:34:38 INFO mapreduce.Job:  map 100% reduce 92%
19/11/06 02:34:40 INFO mapreduce.Job:  map 100% reduce 93%
19/11/06 02:34:42 INFO mapreduce.Job:  map 100% reduce 94%
19/11/06 02:34:45 INFO mapreduce.Job:  map 100% reduce 95%
19/11/06 02:34:48 INFO mapreduce.Job:  map 100% reduce 96%
19/11/06 02:34:52 INFO mapreduce.Job:  map 100% reduce 97%
19/11/06 02:34:57 INFO mapreduce.Job:  map 100% reduce 98%
19/11/06 02:35:06 INFO mapreduce.Job:  map 100% reduce 99%
19/11/06 02:35:22 INFO mapreduce.Job:  map 100% reduce 100%
19/11/06 02:35:46 INFO mapreduce.Job: Job job_1567079137842_610852 completed successfully
19/11/06 02:35:46 INFO mapreduce.Job: Counters: 50
	File System Counters
		FILE: Number of bytes read=19820897663
		FILE: Number of bytes written=55746246627
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=162178909166
		HDFS: Number of bytes written=215054580741
		HDFS: Number of read operations=3600
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=800
	Job Counters 
		Launched map tasks=1000
		Launched reduce tasks=200
		Data-local map tasks=966
		Rack-local map tasks=34
		Total time spent by all maps in occupied slots (ms)=321176768
		Total time spent by all reduces in occupied slots (ms)=117521880
		Total time spent by all map tasks (ms)=40147096
		Total time spent by all reduce tasks (ms)=19586980
		Total vcore-milliseconds taken by all map tasks=40147096
		Total vcore-milliseconds taken by all reduce tasks=19586980
		Total megabyte-milliseconds taken by all map tasks=164442505216
		Total megabyte-milliseconds taken by all reduce tasks=60171202560
	Map-Reduce Framework
		Map input records=76982126
		Map output records=238779932
		Map output bytes=158838953914
		Map output materialized bytes=35773229180
		Input split bytes=174000
		Combine input records=0
		Combine output records=0
		Reduce input groups=9022069
		Reduce shuffle bytes=35773229180
		Reduce input records=238779932
		Reduce output records=155365361
		Spilled Records=477559864
		Shuffled Maps =200000
		Failed Shuffles=0
		Merged Map outputs=200000
		GC time elapsed (ms)=254678
		CPU time spent (ms)=56613660
		Physical memory (bytes) snapshot=1641849835520
		Virtual memory (bytes) snapshot=6291286925312
		Total committed heap usage (bytes)=2228296351744
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=162178735166
	File Output Format Counters 
		Bytes Written=215054580741
19/11/06 02:35:46 INFO streaming.StreamJob: Output directory: /user/ad_user/ctr_space/model_train_exp/shitu/20191102/
+ judge_result hadoop_run
+ [[ 0 -ne 0 ]]
+ echo 'hadoop_run success.'
hadoop_run success.
+ ADFEA_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/adfea/
+ ADFEA_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191102/
+ INS_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/ins/
+ INS_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/ins//20191102/
+ STATINFO_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/
+ STATINFO_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191102/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191102/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191102/
19/11/06 02:35:52 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/adfea/20191102' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191102/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191102/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191102/
19/11/06 02:36:02 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/ins/20191102' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191102/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191102/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191102/
19/11/06 02:36:12 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/20191102' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191102/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191102//part-*-A' /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191102/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191102//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191102//part-*-B' /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191102/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191102//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191102//part-*-C' /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191102/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191102//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191102/
19/11/06 02:36:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191102' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ mylog 'task[20191102] success!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-02:36:50
+ echo '[20191106-02:36:50] task[20191102]' 'success!'
[20191106-02:36:50] task[20191102] success!
+ exit 0
+ bash -x run_shitu.sh 20191103
+ bash /home/ling.fang/kinit_ad_user.sh
+ USER_NAME=ad_user
+ HADOOP_HOME=/usr/local/hadoop-2.6.3
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ common_file=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+ source /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
++ bash /home/ling.fang/kinit_ad_user.sh
++ HADOOP_BIN=/usr/local/hadoop-2.6.3/bin/hadoop
++++ dirname /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+++ cd /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools
+++ pwd
++ ROOT_PATH=/home/work/ling.fang/personal/ling.fang/script/tools
+ '[' 1 -ge 1 ']'
+ DATE=20191103
+ '[' 1 -eq 2 ']'
+ JOB_TAG=_exp
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ INPUTDIR='-input "/user/ad_user/ctr_space/ed_join_click/join/20191103/" '
+ echo -input '"/user/ad_user/ctr_space/ed_join_click/join/20191103/"'
-input "/user/ad_user/ctr_space/ed_join_click/join/20191103/"
+ OUTPUTDIR=/user/ad_user/ctr_space/model_train_exp/shitu/20191103/
+ PLID_EDCLKDIR=/user/ad_user/ctr_space/plid_stat_info/json
+ done_file=/user/ad_user/ctr_space/ed_join_click/join/20191103/_SUCCESS
+ loop_check /user/ad_user/ctr_space/ed_join_click/join/20191103/_SUCCESS 140 1
+ file=/user/ad_user/ctr_space/ed_join_click/join/20191103/_SUCCESS
+ ready=0
+ check_time=140
+ mode=1
+ echo 'input params:/user/ad_user/ctr_space/ed_join_click/join/20191103/_SUCCESS 140 1'
input params:/user/ad_user/ctr_space/ed_join_click/join/20191103/_SUCCESS 140 1
+ '[' 3 -ne 3 ']'
+ '[' 140 -gt 0 ']'
+ '[' 1 -eq 1 ']'
+ hadoop_check_ready
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/ed_join_click/join/20191103/_SUCCESS
+ ready=1
+ '[' 1 -eq 1 ']'
+ mylog '/user/ad_user/ctr_space/ed_join_click/join/20191103/_SUCCESS is ready!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-02:36:53
+ echo '[20191106-02:36:53] /user/ad_user/ctr_space/ed_join_click/join/20191103/_SUCCESS' is 'ready!'
[20191106-02:36:53] /user/ad_user/ctr_space/ed_join_click/join/20191103/_SUCCESS is ready!
+ return 0
+ python script/get_creative_info.py
+ OWNER_INFO=ad_user@cootek.cn
+ TASK_NAME=naga_ctr_generate_shitu_log
+ hadoop_run
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191103/
rm: `/user/ad_user/ctr_space/model_train_exp/shitu/20191103/': No such file or directory
+ /usr/local/hadoop-2.6.3/bin/hadoop jar /usr/local/hadoop-2.6.3/share/hadoop/tools/lib/hadoop-streaming-2.6.3.jar -libjars /home/ling.fang/script/tools/mr_plugins-1.0.jar -files script -D map.output.key.field.separator=# -D num.key.fields.for.partition=1 -D mapreduce.map.memory.mb=4096 -D mapreduce.map.java.opts=-Xmx3276m -Dmapred.map.tasks.speculative.execution=false -Dmapred.reduce.tasks.speculative.execution=false -Dstream.non.zero.exit.is.failure=false -Dmapred.job.priority=HIGH -Dmapreduce.job.queuename=root.ad-root.etl.dailyetl.high -Dmapred.map.tasks=1000 -Dmapred.reduce.tasks=200 -Dmapred.job.map.capacity=1000 -Dmapred.job.reduce.capacity=200 -Dmapred.job.name=naga_ctr_generate_shitu_log_20191103 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -outputformat org.apache.hadoop.mapred.lib.SuffixMultipleTextOutputFormat -mapper 'python script/mapper.py' -reducer 'python script/reducer.py' -input '"/user/ad_user/ctr_space/ed_join_click/join/20191103/"' -output /user/ad_user/ctr_space/model_train_exp/shitu/20191103/
19/11/06 02:36:59 INFO Configuration.deprecation: map.output.key.field.separator is deprecated. Instead, use mapreduce.map.output.key.field.separator
19/11/06 02:36:59 INFO Configuration.deprecation: mapred.map.tasks.speculative.execution is deprecated. Instead, use mapreduce.map.speculative
19/11/06 02:36:59 INFO Configuration.deprecation: mapred.reduce.tasks.speculative.execution is deprecated. Instead, use mapreduce.reduce.speculative
19/11/06 02:36:59 INFO Configuration.deprecation: mapred.job.priority is deprecated. Instead, use mapreduce.job.priority
19/11/06 02:36:59 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
19/11/06 02:36:59 INFO Configuration.deprecation: mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces
19/11/06 02:36:59 INFO Configuration.deprecation: mapred.job.name is deprecated. Instead, use mapreduce.job.name
packageJobJar: [/tmp/hadoop-unjar8005293068507134603/] [] /tmp/streamjob8776960078311214828.jar tmpDir=null
19/11/06 02:36:59 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 02:37:00 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 02:37:01 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 4046894 for ad_user on ha-hdfs:cootek
19/11/06 02:37:01 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046894 for ad_user)
19/11/06 02:37:01 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 02:37:01 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c db 15 2c 8a 01 6e 60 e7 99 2c 8d 31 04 56 8e 02 7f
19/11/06 02:37:09 INFO lzo.GPLNativeCodeLoader: Loaded native gpl library from the embedded binaries
19/11/06 02:37:09 INFO lzo.LzoCodec: Successfully loaded & initialized native-lzo library [hadoop-lzo rev 52decc77982b58949890770d22720a91adce0c3f]
19/11/06 02:37:09 INFO mapred.FileInputFormat: Total input paths to process : 1000
19/11/06 02:37:09 INFO mapreduce.JobSubmitter: number of splits:1000
19/11/06 02:37:10 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1567079137842_610878
19/11/06 02:37:10 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046894 for ad_user)
19/11/06 02:37:10 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 02:37:10 WARN token.Token: Cannot find class for token kind kms-dt
Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c db 15 2c 8a 01 6e 60 e7 99 2c 8d 31 04 56 8e 02 7f
19/11/06 02:37:10 INFO impl.YarnClientImpl: Submitted application application_1567079137842_610878
19/11/06 02:37:10 INFO mapreduce.Job: The url to track the job: http://hadoop2-namenode.corp.cootek.com:8088/proxy/application_1567079137842_610878/
19/11/06 02:37:10 INFO mapreduce.Job: Running job: job_1567079137842_610878
19/11/06 02:37:23 INFO mapreduce.Job: Job job_1567079137842_610878 running in uber mode : false
19/11/06 02:37:23 INFO mapreduce.Job:  map 0% reduce 0%
19/11/06 02:38:12 INFO mapreduce.Job:  map 1% reduce 0%
19/11/06 02:38:26 INFO mapreduce.Job:  map 2% reduce 0%
19/11/06 02:38:30 INFO mapreduce.Job:  map 3% reduce 0%
19/11/06 02:38:34 INFO mapreduce.Job:  map 4% reduce 0%
19/11/06 02:38:37 INFO mapreduce.Job:  map 5% reduce 0%
19/11/06 02:38:39 INFO mapreduce.Job:  map 6% reduce 0%
19/11/06 02:38:41 INFO mapreduce.Job:  map 7% reduce 0%
19/11/06 02:38:43 INFO mapreduce.Job:  map 8% reduce 0%
19/11/06 02:38:44 INFO mapreduce.Job:  map 9% reduce 0%
19/11/06 02:38:46 INFO mapreduce.Job:  map 10% reduce 0%
19/11/06 02:38:47 INFO mapreduce.Job:  map 11% reduce 0%
19/11/06 02:38:49 INFO mapreduce.Job:  map 12% reduce 0%
19/11/06 02:38:50 INFO mapreduce.Job:  map 13% reduce 0%
19/11/06 02:38:52 INFO mapreduce.Job:  map 14% reduce 0%
19/11/06 02:38:53 INFO mapreduce.Job:  map 15% reduce 0%
19/11/06 02:38:54 INFO mapreduce.Job:  map 16% reduce 0%
19/11/06 02:38:56 INFO mapreduce.Job:  map 17% reduce 0%
19/11/06 02:38:57 INFO mapreduce.Job:  map 18% reduce 0%
19/11/06 02:38:58 INFO mapreduce.Job:  map 19% reduce 0%
19/11/06 02:38:59 INFO mapreduce.Job:  map 20% reduce 0%
19/11/06 02:39:00 INFO mapreduce.Job:  map 21% reduce 0%
19/11/06 02:39:01 INFO mapreduce.Job:  map 22% reduce 0%
19/11/06 02:39:02 INFO mapreduce.Job:  map 24% reduce 0%
19/11/06 02:39:04 INFO mapreduce.Job:  map 25% reduce 0%
19/11/06 02:39:05 INFO mapreduce.Job:  map 26% reduce 0%
19/11/06 02:39:06 INFO mapreduce.Job:  map 27% reduce 0%
19/11/06 02:39:07 INFO mapreduce.Job:  map 28% reduce 0%
19/11/06 02:39:08 INFO mapreduce.Job:  map 29% reduce 0%
19/11/06 02:39:09 INFO mapreduce.Job:  map 30% reduce 0%
19/11/06 02:39:10 INFO mapreduce.Job:  map 31% reduce 0%
19/11/06 02:39:11 INFO mapreduce.Job:  map 32% reduce 0%
19/11/06 02:39:12 INFO mapreduce.Job:  map 33% reduce 0%
19/11/06 02:39:13 INFO mapreduce.Job:  map 34% reduce 0%
19/11/06 02:39:15 INFO mapreduce.Job:  map 35% reduce 0%
19/11/06 02:39:16 INFO mapreduce.Job:  map 36% reduce 0%
19/11/06 02:39:18 INFO mapreduce.Job:  map 37% reduce 0%
19/11/06 02:39:20 INFO mapreduce.Job:  map 38% reduce 0%
19/11/06 02:39:21 INFO mapreduce.Job:  map 39% reduce 0%
19/11/06 02:39:22 INFO mapreduce.Job:  map 40% reduce 0%
19/11/06 02:39:24 INFO mapreduce.Job:  map 41% reduce 0%
19/11/06 02:39:25 INFO mapreduce.Job:  map 42% reduce 0%
19/11/06 02:39:27 INFO mapreduce.Job:  map 43% reduce 0%
19/11/06 02:39:28 INFO mapreduce.Job:  map 44% reduce 0%
19/11/06 02:39:29 INFO mapreduce.Job:  map 45% reduce 0%
19/11/06 02:39:31 INFO mapreduce.Job:  map 46% reduce 0%
19/11/06 02:39:32 INFO mapreduce.Job:  map 47% reduce 0%
19/11/06 02:39:34 INFO mapreduce.Job:  map 48% reduce 0%
19/11/06 02:39:35 INFO mapreduce.Job:  map 49% reduce 0%
19/11/06 02:39:36 INFO mapreduce.Job:  map 50% reduce 0%
19/11/06 02:39:37 INFO mapreduce.Job:  map 51% reduce 0%
19/11/06 02:39:38 INFO mapreduce.Job:  map 52% reduce 0%
19/11/06 02:39:40 INFO mapreduce.Job:  map 53% reduce 0%
19/11/06 02:39:41 INFO mapreduce.Job:  map 54% reduce 0%
19/11/06 02:39:42 INFO mapreduce.Job:  map 55% reduce 0%
19/11/06 02:39:43 INFO mapreduce.Job:  map 56% reduce 0%
19/11/06 02:39:44 INFO mapreduce.Job:  map 57% reduce 0%
19/11/06 02:39:45 INFO mapreduce.Job:  map 58% reduce 0%
19/11/06 02:39:47 INFO mapreduce.Job:  map 59% reduce 0%
19/11/06 02:39:48 INFO mapreduce.Job:  map 60% reduce 0%
19/11/06 02:39:49 INFO mapreduce.Job:  map 61% reduce 0%
19/11/06 02:39:50 INFO mapreduce.Job:  map 62% reduce 0%
19/11/06 02:39:51 INFO mapreduce.Job:  map 63% reduce 0%
19/11/06 02:39:53 INFO mapreduce.Job:  map 64% reduce 0%
19/11/06 02:39:54 INFO mapreduce.Job:  map 65% reduce 0%
19/11/06 02:39:56 INFO mapreduce.Job:  map 66% reduce 0%
19/11/06 02:39:57 INFO mapreduce.Job:  map 67% reduce 0%
19/11/06 02:39:59 INFO mapreduce.Job:  map 68% reduce 0%
19/11/06 02:40:00 INFO mapreduce.Job:  map 69% reduce 0%
19/11/06 02:40:02 INFO mapreduce.Job:  map 70% reduce 0%
19/11/06 02:40:04 INFO mapreduce.Job:  map 71% reduce 0%
19/11/06 02:40:05 INFO mapreduce.Job:  map 72% reduce 0%
19/11/06 02:40:07 INFO mapreduce.Job:  map 73% reduce 0%
19/11/06 02:40:09 INFO mapreduce.Job:  map 74% reduce 0%
19/11/06 02:40:10 INFO mapreduce.Job:  map 75% reduce 0%
19/11/06 02:40:12 INFO mapreduce.Job:  map 76% reduce 0%
19/11/06 02:40:13 INFO mapreduce.Job:  map 77% reduce 0%
19/11/06 02:40:14 INFO mapreduce.Job:  map 78% reduce 0%
19/11/06 02:40:15 INFO mapreduce.Job:  map 79% reduce 0%
19/11/06 02:40:17 INFO mapreduce.Job:  map 80% reduce 0%
19/11/06 02:40:18 INFO mapreduce.Job:  map 81% reduce 0%
19/11/06 02:40:19 INFO mapreduce.Job:  map 82% reduce 0%
19/11/06 02:40:20 INFO mapreduce.Job:  map 83% reduce 0%
19/11/06 02:40:21 INFO mapreduce.Job:  map 84% reduce 0%
19/11/06 02:40:22 INFO mapreduce.Job:  map 85% reduce 0%
19/11/06 02:40:24 INFO mapreduce.Job:  map 86% reduce 0%
19/11/06 02:40:25 INFO mapreduce.Job:  map 87% reduce 0%
19/11/06 02:40:26 INFO mapreduce.Job:  map 88% reduce 0%
19/11/06 02:40:27 INFO mapreduce.Job:  map 89% reduce 0%
19/11/06 02:40:28 INFO mapreduce.Job:  map 90% reduce 0%
19/11/06 02:40:29 INFO mapreduce.Job:  map 91% reduce 0%
19/11/06 02:40:31 INFO mapreduce.Job:  map 92% reduce 0%
19/11/06 02:40:33 INFO mapreduce.Job:  map 93% reduce 0%
19/11/06 02:40:34 INFO mapreduce.Job:  map 94% reduce 0%
19/11/06 02:40:36 INFO mapreduce.Job:  map 94% reduce 1%
19/11/06 02:40:37 INFO mapreduce.Job:  map 95% reduce 3%
19/11/06 02:40:38 INFO mapreduce.Job:  map 95% reduce 6%
19/11/06 02:40:39 INFO mapreduce.Job:  map 95% reduce 7%
19/11/06 02:40:40 INFO mapreduce.Job:  map 96% reduce 9%
19/11/06 02:40:41 INFO mapreduce.Job:  map 96% reduce 10%
19/11/06 02:40:42 INFO mapreduce.Job:  map 96% reduce 11%
19/11/06 02:40:43 INFO mapreduce.Job:  map 96% reduce 13%
19/11/06 02:40:45 INFO mapreduce.Job:  map 97% reduce 14%
19/11/06 02:40:46 INFO mapreduce.Job:  map 97% reduce 16%
19/11/06 02:40:47 INFO mapreduce.Job:  map 97% reduce 17%
19/11/06 02:40:48 INFO mapreduce.Job:  map 97% reduce 18%
19/11/06 02:40:49 INFO mapreduce.Job:  map 98% reduce 19%
19/11/06 02:40:53 INFO mapreduce.Job:  map 98% reduce 20%
19/11/06 02:40:54 INFO mapreduce.Job:  map 99% reduce 20%
19/11/06 02:40:55 INFO mapreduce.Job:  map 99% reduce 21%
19/11/06 02:40:57 INFO mapreduce.Job:  map 99% reduce 22%
19/11/06 02:40:59 INFO mapreduce.Job:  map 100% reduce 22%
19/11/06 02:41:01 INFO mapreduce.Job:  map 100% reduce 23%
19/11/06 02:41:03 INFO mapreduce.Job:  map 100% reduce 24%
19/11/06 02:41:05 INFO mapreduce.Job:  map 100% reduce 25%
19/11/06 02:41:06 INFO mapreduce.Job:  map 100% reduce 26%
19/11/06 02:41:07 INFO mapreduce.Job:  map 100% reduce 33%
19/11/06 02:41:08 INFO mapreduce.Job:  map 100% reduce 39%
19/11/06 02:41:09 INFO mapreduce.Job:  map 100% reduce 46%
19/11/06 02:41:10 INFO mapreduce.Job:  map 100% reduce 49%
19/11/06 02:41:11 INFO mapreduce.Job:  map 100% reduce 50%
19/11/06 02:41:12 INFO mapreduce.Job:  map 100% reduce 51%
19/11/06 02:41:16 INFO mapreduce.Job:  map 100% reduce 52%
19/11/06 02:41:20 INFO mapreduce.Job:  map 100% reduce 53%
19/11/06 02:41:23 INFO mapreduce.Job:  map 100% reduce 54%
19/11/06 02:41:27 INFO mapreduce.Job:  map 100% reduce 55%
19/11/06 02:41:31 INFO mapreduce.Job:  map 100% reduce 56%
19/11/06 02:41:34 INFO mapreduce.Job:  map 100% reduce 57%
19/11/06 02:41:38 INFO mapreduce.Job:  map 100% reduce 58%
19/11/06 02:41:41 INFO mapreduce.Job:  map 100% reduce 59%
19/11/06 02:41:44 INFO mapreduce.Job:  map 100% reduce 60%
19/11/06 02:41:46 INFO mapreduce.Job:  map 100% reduce 61%
19/11/06 02:41:48 INFO mapreduce.Job:  map 100% reduce 62%
19/11/06 02:41:50 INFO mapreduce.Job:  map 100% reduce 63%
19/11/06 02:41:53 INFO mapreduce.Job:  map 100% reduce 64%
19/11/06 02:41:56 INFO mapreduce.Job:  map 100% reduce 65%
19/11/06 02:41:59 INFO mapreduce.Job:  map 100% reduce 66%
19/11/06 02:42:03 INFO mapreduce.Job:  map 100% reduce 67%
19/11/06 02:42:06 INFO mapreduce.Job:  map 100% reduce 68%
19/11/06 02:42:08 INFO mapreduce.Job:  map 100% reduce 69%
19/11/06 02:42:10 INFO mapreduce.Job:  map 100% reduce 70%
19/11/06 02:42:11 INFO mapreduce.Job:  map 100% reduce 71%
19/11/06 02:42:13 INFO mapreduce.Job:  map 100% reduce 72%
19/11/06 02:42:16 INFO mapreduce.Job:  map 100% reduce 73%
19/11/06 02:42:18 INFO mapreduce.Job:  map 100% reduce 74%
19/11/06 02:42:21 INFO mapreduce.Job:  map 100% reduce 75%
19/11/06 02:42:23 INFO mapreduce.Job:  map 100% reduce 76%
19/11/06 02:42:24 INFO mapreduce.Job:  map 100% reduce 77%
19/11/06 02:42:25 INFO mapreduce.Job:  map 100% reduce 78%
19/11/06 02:42:27 INFO mapreduce.Job:  map 100% reduce 79%
19/11/06 02:42:30 INFO mapreduce.Job:  map 100% reduce 80%
19/11/06 02:42:33 INFO mapreduce.Job:  map 100% reduce 81%
19/11/06 02:42:34 INFO mapreduce.Job:  map 100% reduce 82%
19/11/06 02:42:35 INFO mapreduce.Job:  map 100% reduce 83%
19/11/06 02:42:38 INFO mapreduce.Job:  map 100% reduce 84%
19/11/06 02:42:42 INFO mapreduce.Job:  map 100% reduce 85%
19/11/06 02:42:46 INFO mapreduce.Job:  map 100% reduce 86%
19/11/06 02:42:48 INFO mapreduce.Job:  map 100% reduce 87%
19/11/06 02:42:52 INFO mapreduce.Job:  map 100% reduce 88%
19/11/06 02:42:57 INFO mapreduce.Job:  map 100% reduce 89%
19/11/06 02:43:02 INFO mapreduce.Job:  map 100% reduce 90%
19/11/06 02:43:13 INFO mapreduce.Job:  map 100% reduce 91%
19/11/06 02:43:17 INFO mapreduce.Job:  map 100% reduce 93%
19/11/06 02:43:18 INFO mapreduce.Job:  map 100% reduce 96%
19/11/06 02:43:23 INFO mapreduce.Job:  map 100% reduce 97%
19/11/06 02:43:35 INFO mapreduce.Job:  map 100% reduce 98%
19/11/06 02:43:49 INFO mapreduce.Job:  map 100% reduce 99%
19/11/06 02:44:08 INFO mapreduce.Job:  map 100% reduce 100%
19/11/06 02:44:50 INFO mapreduce.Job: Job job_1567079137842_610878 completed successfully
19/11/06 02:44:50 INFO mapreduce.Job: Counters: 50
	File System Counters
		FILE: Number of bytes read=21764873271
		FILE: Number of bytes written=61476633069
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=175905773638
		HDFS: Number of bytes written=233892824683
		HDFS: Number of read operations=3600
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=800
	Job Counters 
		Launched map tasks=1000
		Launched reduce tasks=200
		Data-local map tasks=957
		Rack-local map tasks=43
		Total time spent by all maps in occupied slots (ms)=325831672
		Total time spent by all reduces in occupied slots (ms)=129407550
		Total time spent by all map tasks (ms)=40728959
		Total time spent by all reduce tasks (ms)=21567925
		Total vcore-milliseconds taken by all map tasks=40728959
		Total vcore-milliseconds taken by all reduce tasks=21567925
		Total megabyte-milliseconds taken by all map tasks=166825816064
		Total megabyte-milliseconds taken by all reduce tasks=66256665600
	Map-Reduce Framework
		Map input records=83652859
		Map output records=260496681
		Map output bytes=172757858112
		Map output materialized bytes=39559649302
		Input split bytes=174000
		Combine input records=0
		Combine output records=0
		Reduce input groups=10188190
		Reduce shuffle bytes=39559649302
		Reduce input records=260496681
		Reduce output records=168841271
		Spilled Records=520993362
		Shuffled Maps =200000
		Failed Shuffles=0
		Merged Map outputs=200000
		GC time elapsed (ms)=318793
		CPU time spent (ms)=64227990
		Physical memory (bytes) snapshot=1654013370368
		Virtual memory (bytes) snapshot=6289863000064
		Total committed heap usage (bytes)=2236485206016
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=175905599638
	File Output Format Counters 
		Bytes Written=233892824683
19/11/06 02:44:50 INFO streaming.StreamJob: Output directory: /user/ad_user/ctr_space/model_train_exp/shitu/20191103/
+ judge_result hadoop_run
+ [[ 0 -ne 0 ]]
+ echo 'hadoop_run success.'
hadoop_run success.
+ ADFEA_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/adfea/
+ ADFEA_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191103/
+ INS_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/ins/
+ INS_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/ins//20191103/
+ STATINFO_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/
+ STATINFO_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191103/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191103/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191103/
19/11/06 02:44:56 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/adfea/20191103' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191103/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191103/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191103/
19/11/06 02:45:06 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/ins/20191103' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191103/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191103/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191103/
19/11/06 02:45:16 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/20191103' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191103/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191103//part-*-A' /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191103/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191103//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191103//part-*-B' /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191103/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191103//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191103//part-*-C' /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191103/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191103//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191103/
19/11/06 02:45:47 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191103' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ mylog 'task[20191103] success!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-02:45:48
+ echo '[20191106-02:45:48] task[20191103]' 'success!'
[20191106-02:45:48] task[20191103] success!
+ exit 0
+ bash -x run_shitu.sh 20191104
+ bash /home/ling.fang/kinit_ad_user.sh
+ USER_NAME=ad_user
+ HADOOP_HOME=/usr/local/hadoop-2.6.3
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ common_file=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+ source /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
++ bash /home/ling.fang/kinit_ad_user.sh
++ HADOOP_BIN=/usr/local/hadoop-2.6.3/bin/hadoop
++++ dirname /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools/common.sh
+++ cd /home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate/../../../script/tools
+++ pwd
++ ROOT_PATH=/home/work/ling.fang/personal/ling.fang/script/tools
+ '[' 1 -ge 1 ']'
+ DATE=20191104
+ '[' 1 -eq 2 ']'
+ JOB_TAG=_exp
++ pwd
+ ROOT_DIR=/home/work/ling.fang/personal/ling.fang/ctr_space_exp/daily_update/shitu_generate
+ INPUTDIR='-input "/user/ad_user/ctr_space/ed_join_click/join/20191104/" '
+ echo -input '"/user/ad_user/ctr_space/ed_join_click/join/20191104/"'
-input "/user/ad_user/ctr_space/ed_join_click/join/20191104/"
+ OUTPUTDIR=/user/ad_user/ctr_space/model_train_exp/shitu/20191104/
+ PLID_EDCLKDIR=/user/ad_user/ctr_space/plid_stat_info/json
+ done_file=/user/ad_user/ctr_space/ed_join_click/join/20191104/_SUCCESS
+ loop_check /user/ad_user/ctr_space/ed_join_click/join/20191104/_SUCCESS 140 1
+ file=/user/ad_user/ctr_space/ed_join_click/join/20191104/_SUCCESS
+ ready=0
+ check_time=140
+ mode=1
+ echo 'input params:/user/ad_user/ctr_space/ed_join_click/join/20191104/_SUCCESS 140 1'
input params:/user/ad_user/ctr_space/ed_join_click/join/20191104/_SUCCESS 140 1
+ '[' 3 -ne 3 ']'
+ '[' 140 -gt 0 ']'
+ '[' 1 -eq 1 ']'
+ hadoop_check_ready
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/ed_join_click/join/20191104/_SUCCESS
+ ready=1
+ '[' 1 -eq 1 ']'
+ mylog '/user/ad_user/ctr_space/ed_join_click/join/20191104/_SUCCESS is ready!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-02:45:51
+ echo '[20191106-02:45:51] /user/ad_user/ctr_space/ed_join_click/join/20191104/_SUCCESS' is 'ready!'
[20191106-02:45:51] /user/ad_user/ctr_space/ed_join_click/join/20191104/_SUCCESS is ready!
+ return 0
+ python script/get_creative_info.py
+ OWNER_INFO=ad_user@cootek.cn
+ TASK_NAME=naga_ctr_generate_shitu_log
+ hadoop_run
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191104/
19/11/06 02:45:54 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191104' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop jar /usr/local/hadoop-2.6.3/share/hadoop/tools/lib/hadoop-streaming-2.6.3.jar -libjars /home/ling.fang/script/tools/mr_plugins-1.0.jar -files script -D map.output.key.field.separator=# -D num.key.fields.for.partition=1 -D mapreduce.map.memory.mb=4096 -D mapreduce.map.java.opts=-Xmx3276m -Dmapred.map.tasks.speculative.execution=false -Dmapred.reduce.tasks.speculative.execution=false -Dstream.non.zero.exit.is.failure=false -Dmapred.job.priority=HIGH -Dmapreduce.job.queuename=root.ad-root.etl.dailyetl.high -Dmapred.map.tasks=1000 -Dmapred.reduce.tasks=200 -Dmapred.job.map.capacity=1000 -Dmapred.job.reduce.capacity=200 -Dmapred.job.name=naga_ctr_generate_shitu_log_20191104 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -outputformat org.apache.hadoop.mapred.lib.SuffixMultipleTextOutputFormat -mapper 'python script/mapper.py' -reducer 'python script/reducer.py' -input '"/user/ad_user/ctr_space/ed_join_click/join/20191104/"' -output /user/ad_user/ctr_space/model_train_exp/shitu/20191104/
19/11/06 02:45:56 INFO Configuration.deprecation: map.output.key.field.separator is deprecated. Instead, use mapreduce.map.output.key.field.separator
19/11/06 02:45:56 INFO Configuration.deprecation: mapred.map.tasks.speculative.execution is deprecated. Instead, use mapreduce.map.speculative
19/11/06 02:45:56 INFO Configuration.deprecation: mapred.reduce.tasks.speculative.execution is deprecated. Instead, use mapreduce.reduce.speculative
19/11/06 02:45:56 INFO Configuration.deprecation: mapred.job.priority is deprecated. Instead, use mapreduce.job.priority
19/11/06 02:45:56 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
19/11/06 02:45:56 INFO Configuration.deprecation: mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces
19/11/06 02:45:56 INFO Configuration.deprecation: mapred.job.name is deprecated. Instead, use mapreduce.job.name
packageJobJar: [/tmp/hadoop-unjar4382172143288371802/] [] /tmp/streamjob4426948663490019098.jar tmpDir=null
19/11/06 02:45:57 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 02:45:57 INFO client.RMProxy: Connecting to ResourceManager at hadoop2-namenode.corp.cootek.com/192.168.30.10:8032
19/11/06 02:45:58 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 4046934 for ad_user on ha-hdfs:cootek
19/11/06 02:45:58 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046934 for ad_user)
19/11/06 02:45:58 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 02:45:58 INFO security.TokenCache: Got dt for hdfs://cootek; Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c e3 47 f8 8a 01 6e 60 ef cb f8 8d 31 04 7e 8e 02 7f
19/11/06 02:46:05 INFO lzo.GPLNativeCodeLoader: Loaded native gpl library from the embedded binaries
19/11/06 02:46:05 INFO lzo.LzoCodec: Successfully loaded & initialized native-lzo library [hadoop-lzo rev 52decc77982b58949890770d22720a91adce0c3f]
19/11/06 02:46:06 INFO mapred.FileInputFormat: Total input paths to process : 1000
19/11/06 02:46:06 INFO mapreduce.JobSubmitter: number of splits:1000
19/11/06 02:46:06 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1567079137842_610903
19/11/06 02:46:06 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:cootek, Ident: (HDFS_DELEGATION_TOKEN token 4046934 for ad_user)
19/11/06 02:46:06 WARN token.Token: Cannot find class for token kind kms-dt
19/11/06 02:46:06 WARN token.Token: Cannot find class for token kind kms-dt
Kind: kms-dt, Service: 192.168.30.152:16000, Ident: 00 07 61 64 5f 75 73 65 72 06 68 61 64 6f 6f 70 00 8a 01 6e 3c e3 47 f8 8a 01 6e 60 ef cb f8 8d 31 04 7e 8e 02 7f
19/11/06 02:46:07 INFO impl.YarnClientImpl: Submitted application application_1567079137842_610903
19/11/06 02:46:07 INFO mapreduce.Job: The url to track the job: http://hadoop2-namenode.corp.cootek.com:8088/proxy/application_1567079137842_610903/
19/11/06 02:46:07 INFO mapreduce.Job: Running job: job_1567079137842_610903
19/11/06 02:46:29 INFO mapreduce.Job: Job job_1567079137842_610903 running in uber mode : false
19/11/06 02:46:29 INFO mapreduce.Job:  map 0% reduce 0%
19/11/06 02:46:59 INFO mapreduce.Job:  map 1% reduce 0%
19/11/06 02:47:15 INFO mapreduce.Job:  map 2% reduce 0%
19/11/06 02:47:24 INFO mapreduce.Job:  map 3% reduce 0%
19/11/06 02:47:37 INFO mapreduce.Job:  map 4% reduce 0%
19/11/06 02:47:50 INFO mapreduce.Job:  map 5% reduce 0%
19/11/06 02:47:59 INFO mapreduce.Job:  map 6% reduce 0%
19/11/06 02:48:10 INFO mapreduce.Job:  map 7% reduce 0%
19/11/06 02:48:15 INFO mapreduce.Job:  map 8% reduce 0%
19/11/06 02:48:19 INFO mapreduce.Job:  map 9% reduce 0%
19/11/06 02:48:24 INFO mapreduce.Job:  map 10% reduce 0%
19/11/06 02:48:28 INFO mapreduce.Job:  map 11% reduce 0%
19/11/06 02:48:32 INFO mapreduce.Job:  map 12% reduce 0%
19/11/06 02:48:35 INFO mapreduce.Job:  map 13% reduce 0%
19/11/06 02:48:37 INFO mapreduce.Job:  map 14% reduce 0%
19/11/06 02:48:40 INFO mapreduce.Job:  map 15% reduce 0%
19/11/06 02:48:43 INFO mapreduce.Job:  map 16% reduce 0%
19/11/06 02:48:45 INFO mapreduce.Job:  map 17% reduce 0%
19/11/06 02:48:48 INFO mapreduce.Job:  map 18% reduce 0%
19/11/06 02:48:52 INFO mapreduce.Job:  map 19% reduce 0%
19/11/06 02:48:56 INFO mapreduce.Job:  map 20% reduce 0%
19/11/06 02:48:59 INFO mapreduce.Job:  map 21% reduce 0%
19/11/06 02:49:02 INFO mapreduce.Job:  map 22% reduce 0%
19/11/06 02:49:05 INFO mapreduce.Job:  map 23% reduce 0%
19/11/06 02:49:08 INFO mapreduce.Job:  map 24% reduce 0%
19/11/06 02:49:10 INFO mapreduce.Job:  map 25% reduce 0%
19/11/06 02:49:13 INFO mapreduce.Job:  map 26% reduce 0%
19/11/06 02:49:15 INFO mapreduce.Job:  map 27% reduce 0%
19/11/06 02:49:17 INFO mapreduce.Job:  map 28% reduce 0%
19/11/06 02:49:19 INFO mapreduce.Job:  map 29% reduce 0%
19/11/06 02:49:22 INFO mapreduce.Job:  map 30% reduce 0%
19/11/06 02:49:24 INFO mapreduce.Job:  map 31% reduce 0%
19/11/06 02:49:26 INFO mapreduce.Job:  map 32% reduce 0%
19/11/06 02:49:29 INFO mapreduce.Job:  map 33% reduce 0%
19/11/06 02:49:31 INFO mapreduce.Job:  map 34% reduce 0%
19/11/06 02:49:33 INFO mapreduce.Job:  map 35% reduce 0%
19/11/06 02:49:35 INFO mapreduce.Job:  map 36% reduce 0%
19/11/06 02:49:38 INFO mapreduce.Job:  map 37% reduce 0%
19/11/06 02:49:40 INFO mapreduce.Job:  map 38% reduce 0%
19/11/06 02:49:44 INFO mapreduce.Job:  map 39% reduce 0%
19/11/06 02:49:46 INFO mapreduce.Job:  map 40% reduce 0%
19/11/06 02:49:47 INFO mapreduce.Job:  map 41% reduce 0%
19/11/06 02:49:49 INFO mapreduce.Job:  map 42% reduce 0%
19/11/06 02:49:51 INFO mapreduce.Job:  map 43% reduce 0%
19/11/06 02:49:52 INFO mapreduce.Job:  map 44% reduce 0%
19/11/06 02:49:54 INFO mapreduce.Job:  map 45% reduce 0%
19/11/06 02:49:55 INFO mapreduce.Job:  map 46% reduce 0%
19/11/06 02:49:57 INFO mapreduce.Job:  map 47% reduce 0%
19/11/06 02:49:58 INFO mapreduce.Job:  map 48% reduce 0%
19/11/06 02:49:59 INFO mapreduce.Job:  map 49% reduce 0%
19/11/06 02:50:01 INFO mapreduce.Job:  map 50% reduce 0%
19/11/06 02:50:03 INFO mapreduce.Job:  map 51% reduce 0%
19/11/06 02:50:04 INFO mapreduce.Job:  map 52% reduce 0%
19/11/06 02:50:05 INFO mapreduce.Job:  map 53% reduce 0%
19/11/06 02:50:07 INFO mapreduce.Job:  map 54% reduce 0%
19/11/06 02:50:08 INFO mapreduce.Job:  map 55% reduce 0%
19/11/06 02:50:10 INFO mapreduce.Job:  map 56% reduce 0%
19/11/06 02:50:11 INFO mapreduce.Job:  map 57% reduce 0%
19/11/06 02:50:12 INFO mapreduce.Job:  map 58% reduce 0%
19/11/06 02:50:13 INFO mapreduce.Job:  map 59% reduce 0%
19/11/06 02:50:14 INFO mapreduce.Job:  map 60% reduce 0%
19/11/06 02:50:15 INFO mapreduce.Job:  map 61% reduce 0%
19/11/06 02:50:16 INFO mapreduce.Job:  map 62% reduce 0%
19/11/06 02:50:17 INFO mapreduce.Job:  map 63% reduce 0%
19/11/06 02:50:19 INFO mapreduce.Job:  map 64% reduce 0%
19/11/06 02:50:20 INFO mapreduce.Job:  map 65% reduce 0%
19/11/06 02:50:21 INFO mapreduce.Job:  map 66% reduce 0%
19/11/06 02:50:23 INFO mapreduce.Job:  map 67% reduce 0%
19/11/06 02:50:24 INFO mapreduce.Job:  map 68% reduce 0%
19/11/06 02:50:26 INFO mapreduce.Job:  map 69% reduce 0%
19/11/06 02:50:27 INFO mapreduce.Job:  map 70% reduce 0%
19/11/06 02:50:29 INFO mapreduce.Job:  map 71% reduce 0%
19/11/06 02:50:30 INFO mapreduce.Job:  map 72% reduce 0%
19/11/06 02:50:32 INFO mapreduce.Job:  map 73% reduce 0%
19/11/06 02:50:33 INFO mapreduce.Job:  map 74% reduce 0%
19/11/06 02:50:35 INFO mapreduce.Job:  map 76% reduce 0%
19/11/06 02:50:36 INFO mapreduce.Job:  map 77% reduce 0%
19/11/06 02:50:38 INFO mapreduce.Job:  map 78% reduce 0%
19/11/06 02:50:39 INFO mapreduce.Job:  map 79% reduce 0%
19/11/06 02:50:41 INFO mapreduce.Job:  map 80% reduce 0%
19/11/06 02:50:43 INFO mapreduce.Job:  map 81% reduce 0%
19/11/06 02:50:44 INFO mapreduce.Job:  map 82% reduce 0%
19/11/06 02:50:46 INFO mapreduce.Job:  map 83% reduce 0%
19/11/06 02:50:48 INFO mapreduce.Job:  map 84% reduce 0%
19/11/06 02:50:49 INFO mapreduce.Job:  map 85% reduce 0%
19/11/06 02:50:50 INFO mapreduce.Job:  map 86% reduce 0%
19/11/06 02:50:52 INFO mapreduce.Job:  map 87% reduce 0%
19/11/06 02:50:53 INFO mapreduce.Job:  map 88% reduce 0%
19/11/06 02:50:54 INFO mapreduce.Job:  map 89% reduce 0%
19/11/06 02:50:56 INFO mapreduce.Job:  map 90% reduce 0%
19/11/06 02:50:57 INFO mapreduce.Job:  map 91% reduce 0%
19/11/06 02:50:58 INFO mapreduce.Job:  map 92% reduce 0%
19/11/06 02:51:00 INFO mapreduce.Job:  map 93% reduce 0%
19/11/06 02:51:02 INFO mapreduce.Job:  map 94% reduce 0%
19/11/06 02:51:04 INFO mapreduce.Job:  map 95% reduce 1%
19/11/06 02:51:06 INFO mapreduce.Job:  map 96% reduce 2%
19/11/06 02:51:08 INFO mapreduce.Job:  map 96% reduce 3%
19/11/06 02:51:09 INFO mapreduce.Job:  map 97% reduce 4%
19/11/06 02:51:10 INFO mapreduce.Job:  map 97% reduce 5%
19/11/06 02:51:11 INFO mapreduce.Job:  map 98% reduce 6%
19/11/06 02:51:13 INFO mapreduce.Job:  map 98% reduce 7%
19/11/06 02:51:14 INFO mapreduce.Job:  map 98% reduce 9%
19/11/06 02:51:15 INFO mapreduce.Job:  map 99% reduce 10%
19/11/06 02:51:17 INFO mapreduce.Job:  map 99% reduce 11%
19/11/06 02:51:19 INFO mapreduce.Job:  map 99% reduce 12%
19/11/06 02:51:20 INFO mapreduce.Job:  map 100% reduce 12%
19/11/06 02:51:22 INFO mapreduce.Job:  map 100% reduce 13%
19/11/06 02:51:24 INFO mapreduce.Job:  map 100% reduce 14%
19/11/06 02:51:26 INFO mapreduce.Job:  map 100% reduce 15%
19/11/06 02:51:28 INFO mapreduce.Job:  map 100% reduce 17%
19/11/06 02:51:29 INFO mapreduce.Job:  map 100% reduce 21%
19/11/06 02:51:30 INFO mapreduce.Job:  map 100% reduce 25%
19/11/06 02:51:31 INFO mapreduce.Job:  map 100% reduce 30%
19/11/06 02:51:32 INFO mapreduce.Job:  map 100% reduce 32%
19/11/06 02:51:33 INFO mapreduce.Job:  map 100% reduce 33%
19/11/06 02:51:34 INFO mapreduce.Job:  map 100% reduce 35%
19/11/06 02:51:35 INFO mapreduce.Job:  map 100% reduce 39%
19/11/06 02:51:36 INFO mapreduce.Job:  map 100% reduce 43%
19/11/06 02:51:37 INFO mapreduce.Job:  map 100% reduce 45%
19/11/06 02:51:38 INFO mapreduce.Job:  map 100% reduce 47%
19/11/06 02:51:39 INFO mapreduce.Job:  map 100% reduce 48%
19/11/06 02:51:41 INFO mapreduce.Job:  map 100% reduce 49%
19/11/06 02:51:43 INFO mapreduce.Job:  map 100% reduce 55%
19/11/06 02:51:44 INFO mapreduce.Job:  map 100% reduce 59%
19/11/06 02:51:45 INFO mapreduce.Job:  map 100% reduce 62%
19/11/06 02:51:46 INFO mapreduce.Job:  map 100% reduce 63%
19/11/06 02:51:47 INFO mapreduce.Job:  map 100% reduce 64%
19/11/06 02:51:48 INFO mapreduce.Job:  map 100% reduce 65%
19/11/06 02:51:51 INFO mapreduce.Job:  map 100% reduce 66%
19/11/06 02:51:53 INFO mapreduce.Job:  map 100% reduce 67%
19/11/06 02:51:55 INFO mapreduce.Job:  map 100% reduce 68%
19/11/06 02:51:57 INFO mapreduce.Job:  map 100% reduce 69%
19/11/06 02:51:59 INFO mapreduce.Job:  map 100% reduce 70%
19/11/06 02:52:01 INFO mapreduce.Job:  map 100% reduce 71%
19/11/06 02:52:03 INFO mapreduce.Job:  map 100% reduce 72%
19/11/06 02:52:06 INFO mapreduce.Job:  map 100% reduce 73%
19/11/06 02:52:08 INFO mapreduce.Job:  map 100% reduce 74%
19/11/06 02:52:10 INFO mapreduce.Job:  map 100% reduce 75%
19/11/06 02:52:12 INFO mapreduce.Job:  map 100% reduce 76%
19/11/06 02:52:15 INFO mapreduce.Job:  map 100% reduce 77%
19/11/06 02:52:17 INFO mapreduce.Job:  map 100% reduce 78%
19/11/06 02:52:19 INFO mapreduce.Job:  map 100% reduce 79%
19/11/06 02:52:21 INFO mapreduce.Job:  map 100% reduce 80%
19/11/06 02:52:23 INFO mapreduce.Job:  map 100% reduce 81%
19/11/06 02:52:25 INFO mapreduce.Job:  map 100% reduce 82%
19/11/06 02:52:27 INFO mapreduce.Job:  map 100% reduce 83%
19/11/06 02:52:30 INFO mapreduce.Job:  map 100% reduce 84%
19/11/06 02:52:32 INFO mapreduce.Job:  map 100% reduce 85%
19/11/06 02:52:36 INFO mapreduce.Job:  map 100% reduce 87%
19/11/06 02:52:37 INFO mapreduce.Job:  map 100% reduce 90%
19/11/06 02:52:38 INFO mapreduce.Job:  map 100% reduce 92%
19/11/06 02:52:40 INFO mapreduce.Job:  map 100% reduce 93%
19/11/06 02:52:45 INFO mapreduce.Job:  map 100% reduce 94%
19/11/06 02:52:50 INFO mapreduce.Job:  map 100% reduce 95%
19/11/06 02:52:53 INFO mapreduce.Job:  map 100% reduce 96%
19/11/06 02:52:57 INFO mapreduce.Job:  map 100% reduce 97%
19/11/06 02:53:05 INFO mapreduce.Job:  map 100% reduce 98%
19/11/06 02:53:17 INFO mapreduce.Job:  map 100% reduce 99%
19/11/06 02:53:35 INFO mapreduce.Job:  map 100% reduce 100%
19/11/06 02:54:44 INFO mapreduce.Job: Job job_1567079137842_610903 completed successfully
19/11/06 02:54:44 INFO mapreduce.Job: Counters: 50
	File System Counters
		FILE: Number of bytes read=21489206518
		FILE: Number of bytes written=60358325606
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=171392965341
		HDFS: Number of bytes written=228104589173
		HDFS: Number of read operations=3600
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=800
	Job Counters 
		Launched map tasks=1000
		Launched reduce tasks=200
		Data-local map tasks=958
		Rack-local map tasks=42
		Total time spent by all maps in occupied slots (ms)=320439928
		Total time spent by all reduces in occupied slots (ms)=100161462
		Total time spent by all map tasks (ms)=40054991
		Total time spent by all reduce tasks (ms)=16693577
		Total vcore-milliseconds taken by all map tasks=40054991
		Total vcore-milliseconds taken by all reduce tasks=16693577
		Total megabyte-milliseconds taken by all map tasks=164065243136
		Total megabyte-milliseconds taken by all reduce tasks=51282668544
	Map-Reduce Framework
		Map input records=81586106
		Map output records=262481571
		Map output bytes=168996839035
		Map output materialized bytes=38717005668
		Input split bytes=174000
		Combine input records=0
		Combine output records=0
		Reduce input groups=9529478
		Reduce shuffle bytes=38717005668
		Reduce input records=262481571
		Reduce output records=164785108
		Spilled Records=524963142
		Shuffled Maps =200000
		Failed Shuffles=0
		Merged Map outputs=200000
		GC time elapsed (ms)=270070
		CPU time spent (ms)=60103650
		Physical memory (bytes) snapshot=1657688399872
		Virtual memory (bytes) snapshot=6292260077568
		Total committed heap usage (bytes)=2238816714752
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=171392791341
	File Output Format Counters 
		Bytes Written=228104589173
19/11/06 02:54:44 INFO streaming.StreamJob: Output directory: /user/ad_user/ctr_space/model_train_exp/shitu/20191104/
+ judge_result hadoop_run
+ [[ 0 -ne 0 ]]
+ echo 'hadoop_run success.'
hadoop_run success.
+ ADFEA_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/adfea/
+ ADFEA_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191104/
+ INS_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/ins/
+ INS_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/ins//20191104/
+ STATINFO_DIR=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/
+ STATINFO_PATH=/user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191104/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191104/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191104/
19/11/06 02:54:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/adfea/20191104' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191104/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191104/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191104/
19/11/06 02:55:00 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/ins/20191104' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191104/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -test -e /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191104/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191104/
19/11/06 02:55:12 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/statinfo/20191104' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mkdir -p /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191104/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191104//part-*-A' /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191104/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/adfea//20191104//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191104//part-*-B' /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191104/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/statinfo//20191104//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -mv '/user/ad_user/ctr_space/model_train_exp/shitu/20191104//part-*-C' /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191104/
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -touchz /user/ad_user/ctr_space/model_train_exp/shitu/ins//20191104//_SUCCESS
+ /usr/local/hadoop-2.6.3/bin/hadoop fs -rm -r /user/ad_user/ctr_space/model_train_exp/shitu/20191104/
19/11/06 02:55:43 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 1440 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://cootek/user/ad_user/ctr_space/model_train_exp/shitu/20191104' to trash at: hdfs://cootek/user/ad_user/.Trash/Current
+ mylog 'task[20191104] success!'
++ date +%Y%m%d-%H:%M:%S
+ now=20191106-02:55:43
+ echo '[20191106-02:55:43] task[20191104]' 'success!'
[20191106-02:55:43] task[20191104] success!
+ exit 0
